{"type":"coze-workflow-clipboard-data","source":{"workflowId":"7533693218530131978","spaceId":"","host":"www.coze.cn","isDouyin":false,"flowMode":0},"json":{"edges":[{"sourceNodeID":"180385","sourcePortID":"true","targetNodeID":"176492"},{"sourceNodeID":"176492","sourcePortID":"","targetNodeID":"168273"},{"sourceNodeID":"175205","sourcePortID":"","targetNodeID":"119835"},{"sourceNodeID":"119835","sourcePortID":"","targetNodeID":"178582"},{"sourceNodeID":"178582","sourcePortID":"","targetNodeID":"117759"},{"sourceNodeID":"117759","sourcePortID":"","targetNodeID":"174538"},{"sourceNodeID":"195903","sourcePortID":"","targetNodeID":"121500"},{"sourceNodeID":"108685","sourcePortID":"","targetNodeID":"121500"},{"sourceNodeID":"150753","sourcePortID":"","targetNodeID":"121500"},{"sourceNodeID":"121500","sourcePortID":"","targetNodeID":"126860"},{"sourceNodeID":"177705","sourcePortID":"","targetNodeID":"192103"},{"sourceNodeID":"192103","sourcePortID":"","targetNodeID":"124207"},{"sourceNodeID":"135573","sourcePortID":"loop-output","targetNodeID":"175205"},{"sourceNodeID":"120003","sourcePortID":"","targetNodeID":"178517"},{"sourceNodeID":"178517","sourcePortID":"","targetNodeID":"310628"},{"sourceNodeID":"196678","sourcePortID":"","targetNodeID":"135573"},{"sourceNodeID":"168273","sourcePortID":"","targetNodeID":"168602"},{"sourceNodeID":"168602","sourcePortID":"","targetNodeID":"310628"},{"sourceNodeID":"137843","sourcePortID":"","targetNodeID":"310628"},{"sourceNodeID":"101419","sourcePortID":"","targetNodeID":"310628"},{"sourceNodeID":"310628","sourcePortID":"","targetNodeID":"186834"},{"sourceNodeID":"186834","sourcePortID":"","targetNodeID":"196678"},{"sourceNodeID":"174538","sourcePortID":"","targetNodeID":"177705"},{"sourceNodeID":"124207","sourcePortID":"","targetNodeID":"110750"},{"sourceNodeID":"110750","sourcePortID":"true","targetNodeID":"195903"},{"sourceNodeID":"110750","sourcePortID":"true_1","targetNodeID":"108685"},{"sourceNodeID":"110750","sourcePortID":"false","targetNodeID":"150753"},{"sourceNodeID":"168273","sourcePortID":"","targetNodeID":"101419"},{"sourceNodeID":"180385","sourcePortID":"false","targetNodeID":"137312"},{"sourceNodeID":"137312","sourcePortID":"","targetNodeID":"168273"},{"sourceNodeID":"168273","sourcePortID":"","targetNodeID":"120003"},{"sourceNodeID":"168273","sourcePortID":"","targetNodeID":"137843"}],"nodes":[{"blocks":[],"data":{"inputs":{"fcParam":{"llmNodeUID":"","pluginFCParam":{},"spaceID":"","workflowVersion":""},"fcParamVar":{"knowledgeFCParam":{}},"inputParameters":[{"input":{"type":"string","value":{"content":{"blockID":"100001","name":"title","source":"block-output"},"type":"ref"}},"name":"title"}],"llmParam":[{"input":{"type":"float","value":{"content":"0.3","rawMeta":{"type":4},"type":"literal"}},"name":"temperature"},{"input":{"type":"integer","value":{"content":"4096","rawMeta":{"type":2},"type":"literal"}},"name":"maxTokens"},{"input":{"type":"integer","value":{"content":"2","rawMeta":{"type":2},"type":"literal"}},"name":"responseFormat"},{"input":{"type":"string","value":{"content":"豆包·1.5·Pro·32k","rawMeta":{"type":1},"type":"literal"}},"name":"modleName"},{"input":{"type":"integer","value":{"content":"1737521813","rawMeta":{"type":2},"type":"literal"}},"name":"modelType"},{"input":{"type":"string","value":{"content":"precise","rawMeta":{"type":1},"type":"literal"}},"name":"generationDiversity"},{"input":{"type":"string","value":{"content":"书籍名称：《{{title}}》","rawMeta":{"type":1},"type":"literal"}},"name":"prompt"},{"input":{"type":"boolean","value":{"content":false,"rawMeta":{"type":3},"type":"literal"}},"name":"enableChatHistory"},{"input":{"type":"integer","value":{"content":"3","rawMeta":{"type":2},"type":"literal"}},"name":"chatHistoryRound"},{"input":{"type":"string","value":{"content":"# 经典书籍金句推荐\n你是一位专业的书评人，清模仿董宇辉的风格，根据用户提供的书籍名称，撰写出专业且有深度的金句评论，输出 200字左右的顶级感悟文案。\n#格式\n输出文案，合理分段以数组列表输出每段内容\n并给出书籍名称、作者名称","rawMeta":{"type":1},"type":"literal"}},"name":"systemPrompt"},{"input":{"type":"string","value":{"content":"","rawMeta":{"type":1},"type":"literal"}},"name":"stableSystemPrompt"},{"input":{"type":"boolean","value":{"content":false,"rawMeta":{"type":3},"type":"literal"}},"name":"canContinue"}],"settingOnError":{"processType":1,"retryTimes":0,"switch":false,"timeoutMs":600000}},"nodeMeta":{"description":"调用大语言模型,使用变量和提示词生成回复","icon":"https://lf3-static.bytednsdoc.com/obj/eden-cn/dvsmryvd_avi_dvsm/ljhwZthlaukjlkulzlp/icon/icon-LLM-v2.jpg","subTitle":"大模型","title":"大模型"},"outputs":[{"name":"contentList","required":false,"schema":{"type":"string"},"type":"list"},{"name":"title","required":false,"type":"string"},{"name":"author","required":false,"type":"string"}],"version":"3"},"edges":null,"id":"176492","meta":{"position":{"x":-4573.506898139484,"y":755.2365408505923}},"type":"3","_temp":{"bounds":{"x":0,"y":0,"width":0,"height":0}}},{"blocks":[],"data":{"inputs":{"apiParam":[{"input":{"type":"string","value":{"content":"7457837955684515874","type":"literal"}},"name":"apiID"},{"input":{"type":"string","value":{"content":"create_draft","type":"literal"}},"name":"apiName"},{"input":{"type":"string","value":{"content":"7457837925833801768","type":"literal"}},"name":"pluginID"},{"input":{"type":"string","value":{"content":"剪映草稿","type":"literal"}},"name":"pluginName"},{"input":{"type":"string","value":{"content":"","type":"literal"}},"name":"pluginVersion"},{"input":{"type":"string","value":{"content":"","type":"literal"}},"name":"tips"},{"input":{"type":"string","value":{"content":"","type":"literal"}},"name":"outDocLink"},{"input":{"type":"integer","value":{"content":1747376521,"type":"literal"}},"name":"updateTime"}],"inputDefs":[{"description":"高","input":{},"name":"height","required":false,"type":"integer"},{"description":"关联创作者","input":{},"name":"user_id","required":false,"type":"integer"},{"description":"宽","input":{},"name":"width","required":false,"type":"integer"}],"inputParameters":[{"input":{"type":"string","value":{"content":"1080","type":"literal"}},"name":"height"},{"input":{"type":"string","value":{"content":"7358","type":"literal"}},"name":"user_id"},{"input":{"type":"string","value":{"content":"1920","type":"literal"}},"name":"width"}],"settingOnError":{"processType":1,"retryTimes":0,"timeoutMs":180000}},"nodeMeta":{"description":"创建草稿","icon":"https://lf3-static.bytednsdoc.com/obj/eden-cn/dvsmryvd_avi_dvsm/ljhwZthlaukjlkulzlp/icon/icon-Plugin-v2.jpg","subtitle":"剪映草稿:create_draft","title":"create_draft"},"outputs":[{"name":"draft_url","required":false,"type":"string"},{"name":"tip_url","required":false,"type":"string"}]},"edges":null,"id":"119835","meta":{"position":{"x":1606.4931018605153,"y":861.5865408505922}},"type":"4","_temp":{"bounds":{"x":0,"y":0,"width":0,"height":0}}},{"blocks":[],"data":{"inputs":{"apiParam":[{"input":{"type":"string","value":{"content":"7457837925833834536","type":"literal"}},"name":"apiID"},{"input":{"type":"string","value":{"content":"add_audios","type":"literal"}},"name":"apiName"},{"input":{"type":"string","value":{"content":"7457837925833801768","type":"literal"}},"name":"pluginID"},{"input":{"type":"string","value":{"content":"剪映草稿","type":"literal"}},"name":"pluginName"},{"input":{"type":"string","value":{"content":"","type":"literal"}},"name":"pluginVersion"},{"input":{"type":"string","value":{"content":"","type":"literal"}},"name":"tips"},{"input":{"type":"string","value":{"content":"","type":"literal"}},"name":"outDocLink"},{"input":{"type":"integer","value":{"content":1742402176,"type":"literal"}},"name":"updateTime"}],"inputDefs":[{"description":"[{\"audio_url\": \"http://example.com/audio1.mp3\",\"duration\":120,\"start\":0,\"end\":12000000,\"audio_effect\":\"教堂\"}]","input":{},"name":"audio_infos","required":true,"type":"string"},{"description":"草稿地址，使用create_draft输出的draft_url即可","input":{},"name":"draft_url","required":true,"type":"string"}],"inputParameters":[{"input":{"type":"string","value":{"content":{"blockID":"175205","name":"audios","source":"block-output"},"rawMeta":{"type":1},"type":"ref"}},"name":"audio_infos"},{"input":{"type":"string","value":{"content":{"blockID":"119835","name":"draft_url","source":"block-output"},"rawMeta":{"type":1},"type":"ref"}},"name":"draft_url"}],"settingOnError":{"processType":1,"retryTimes":0,"timeoutMs":180000}},"nodeMeta":{"description":"批量添加音频","icon":"https://lf3-static.bytednsdoc.com/obj/eden-cn/dvsmryvd_avi_dvsm/ljhwZthlaukjlkulzlp/icon/icon-Plugin-v2.jpg","subtitle":"剪映草稿:add_audios","title":"add_audios"},"outputs":[{"name":"audio_ids","required":false,"schema":{"type":"string"},"type":"list"},{"name":"draft_url","required":false,"type":"string"},{"name":"track_id","required":false,"type":"string"}]},"edges":null,"id":"117759","meta":{"position":{"x":2526.4931018605153,"y":873.5865408505922}},"type":"4","_temp":{"bounds":{"x":0,"y":0,"width":0,"height":0}}},{"blocks":[],"data":{"inputs":{"apiParam":[{"input":{"type":"string","value":{"content":"7457837925833850920","type":"literal"}},"name":"apiID"},{"input":{"type":"string","value":{"content":"add_captions","type":"literal"}},"name":"apiName"},{"input":{"type":"string","value":{"content":"7457837925833801768","type":"literal"}},"name":"pluginID"},{"input":{"type":"string","value":{"content":"剪映草稿","type":"literal"}},"name":"pluginName"},{"input":{"type":"string","value":{"content":"","type":"literal"}},"name":"pluginVersion"},{"input":{"type":"string","value":{"content":"","type":"literal"}},"name":"tips"},{"input":{"type":"string","value":{"content":"","type":"literal"}},"name":"outDocLink"},{"input":{"type":"integer","value":{"content":1742402176,"type":"literal"}},"name":"updateTime"}],"inputDefs":[{"description":"边框颜色，eg：#fe8a80","input":{},"name":"border_color","required":false,"type":"string"},{"description":"草稿地址，使用create_draft输出的draft_url即可","input":{},"name":"draft_url","required":true,"type":"string"},{"description":"行间距，默认0","input":{},"name":"line_spacing","required":false,"type":"float"},{"description":"scale_y缩放","input":{},"name":"scale_y","required":false,"type":"float"},{"description":"0 默认。1富文本样式","input":{},"name":"style_text","required":false,"type":"integer"},{"description":"transform_y位置","input":{},"name":"transform_y","required":false,"type":"float"},{"description":"字幕的对齐方式，0左对齐，1 居中对齐，2右对齐","input":{},"name":"alignment","required":false,"type":"integer"},{"description":"查看说明：https://krxc4izye0.feishu.cn/wiki/HhQrw3BFhi1XGOkkJCBcfkqGnwf?from=from_copylink","input":{},"name":"captions","required":true,"type":"string"},{"description":"字体列表：https://krxc4izye0.feishu.cn/wiki/SmnrwabXriG7JckEzyGcChk4nDd","input":{},"name":"font","required":false,"type":"string"},{"description":"默认：15","input":{},"name":"font_size","required":false,"type":"integer"},{"description":"字间距，默认0","input":{},"name":"letter_spacing","required":false,"type":"float"},{"description":"scale_x缩放","input":{},"name":"scale_x","required":false,"type":"float"},{"description":"文字颜色：#ff1837","input":{},"name":"text_color","required":false,"type":"string"},{"description":"transform_x位置","input":{},"name":"transform_x","required":false,"type":"float"}],"inputParameters":[{"input":{"type":"string","value":{"content":{"blockID":"175205","name":"captions","source":"block-output"},"rawMeta":{"type":1},"type":"ref"}},"name":"captions"},{"input":{"type":"string","value":{"content":{"blockID":"119835","name":"draft_url","source":"block-output"},"rawMeta":{"type":1},"type":"ref"}},"name":"draft_url"},{"input":{"type":"string","value":{"content":"#000000","rawMeta":{"type":1},"type":"literal"}},"name":"border_color"},{"input":{"type":"string","value":{"content":"金陵体","rawMeta":{"type":1},"type":"literal"}},"name":"font"},{"input":{"type":"integer","value":{"content":8,"rawMeta":{"type":2},"type":"literal"}},"name":"font_size"},{"input":{"type":"string","value":{"content":"#ffffff","rawMeta":{"type":1},"type":"literal"}},"name":"text_color"}],"settingOnError":{"processType":1,"retryTimes":0,"timeoutMs":180000}},"nodeMeta":{"description":"批量添加字幕","icon":"https://lf3-static.bytednsdoc.com/obj/eden-cn/dvsmryvd_avi_dvsm/ljhwZthlaukjlkulzlp/icon/icon-Plugin-v2.jpg","subtitle":"剪映草稿:add_captions","title":"add_captions"},"outputs":[{"name":"draft_url","required":false,"type":"string"},{"name":"segment_ids","required":false,"schema":{"type":"string"},"type":"list"},{"name":"segment_infos","required":false,"schema":{"schema":[{"name":"end","required":false,"type":"integer"},{"name":"id","required":false,"type":"string"},{"name":"start","required":false,"type":"integer"}],"type":"object"},"type":"list"},{"name":"text_ids","required":false,"schema":{"type":"string"},"type":"list"},{"name":"track_id","required":false,"type":"string"}]},"edges":null,"id":"121500","meta":{"position":{"x":5746.493101860516,"y":873.5865408505922}},"type":"4","_temp":{"bounds":{"x":0,"y":0,"width":0,"height":0}}},{"blocks":[],"data":{"inputs":{"apiParam":[{"input":{"type":"string","value":{"content":"7457837925833883688","type":"literal"}},"name":"apiID"},{"input":{"type":"string","value":{"content":"add_images","type":"literal"}},"name":"apiName"},{"input":{"type":"string","value":{"content":"7457837925833801768","type":"literal"}},"name":"pluginID"},{"input":{"type":"string","value":{"content":"剪映草稿","type":"literal"}},"name":"pluginName"},{"input":{"type":"string","value":{"content":"","type":"literal"}},"name":"pluginVersion"},{"input":{"type":"string","value":{"content":"","type":"literal"}},"name":"tips"},{"input":{"type":"string","value":{"content":"","type":"literal"}},"name":"outDocLink"},{"input":{"type":"integer","value":{"content":1742402176,"type":"literal"}},"name":"updateTime"}],"inputDefs":[{"description":"y缩放","input":{},"name":"scale_y","required":false,"type":"float"},{"description":"移动transform_x","input":{},"name":"transform_x","required":false,"type":"float"},{"description":"移动transform_y","input":{},"name":"transform_y","required":false,"type":"float"},{"description":"草稿地址，使用create_draft输出的draft_url即可","input":{},"name":"draft_url","required":true,"type":"string"},{"description":"查看说明：https://krxc4izye0.feishu.cn/wiki/Pgm9wXA4EipKhYkeEQJcLBlJnWb?from=from_copylink","input":{},"name":"image_infos","required":true,"type":"string"},{"description":"x缩放","input":{},"name":"scale_x","required":false,"type":"float"}],"inputParameters":[{"input":{"type":"string","value":{"content":{"blockID":"119835","name":"draft_url","source":"block-output"},"rawMeta":{"type":1},"type":"ref"}},"name":"draft_url"},{"input":{"type":"string","value":{"content":{"blockID":"175205","name":"imgs2","source":"block-output"},"rawMeta":{"type":1},"type":"ref"}},"name":"image_infos"}],"settingOnError":{"processType":1,"retryTimes":0,"timeoutMs":180000}},"nodeMeta":{"description":"批量添加图片","icon":"https://lf3-static.bytednsdoc.com/obj/eden-cn/dvsmryvd_avi_dvsm/ljhwZthlaukjlkulzlp/icon/icon-Plugin-v2.jpg","subtitle":"剪映草稿:add_images","title":"add_images_cover2"},"outputs":[{"name":"segment_ids","required":false,"schema":{"type":"string"},"type":"list"},{"name":"segment_infos","required":false,"schema":{"schema":[{"name":"end","required":false,"type":"integer"},{"name":"id","required":false,"type":"string"},{"name":"start","required":false,"type":"integer"}],"type":"object"},"type":"list"},{"name":"track_id","required":false,"type":"string"},{"name":"draft_url","required":false,"type":"string"},{"name":"image_ids","required":false,"schema":{"type":"string"},"type":"list"}]},"edges":null,"id":"192103","meta":{"position":{"x":3906.4931018605153,"y":873.5865408505922}},"type":"4","_temp":{"bounds":{"x":0,"y":0,"width":0,"height":0}}},{"blocks":[],"data":{"inputs":{"code":"import json\nasync def main(args: Args) -> Output:\n    params = args.params\n    #固定参数\n    # bgm = params.get('bgm',\"https://houht.oss-cn-shanghai.aliyuncs.com/public/booklist/bgm2.MP3\"),\n    cover_image = params['pic']\n    bg_image = params['bg_pic']\n    audio_duration = params['audio_duration']\n    toptitle = params['toptitle']\n    width = params['width']\n    height = params['height']\n\n    pre_time = params['pre_time']\n\n    imgs1 = []\n    imgs2 = []\n    title_captions = []\n    bgm_audios = []\n\n    title_captions.append({\n        'text': params['title'],\n        'start': audio_duration+1000000,\n        'end': pre_time,\n        \"in_animation\":\"缩小\",\n        \"in_animation_duration\":2000000\n    })\n    topcaptions = []\n    topcaptions.append({\n        'text': toptitle,\n        'start': audio_duration+1000000,\n        'end': pre_time,\n        \"in_animation\":\"渐显\",\n        \"in_animation_duration\":1000000\n    })\n\n    #获取已有字幕音频\n    audios = params['audio_list']\n\n    #=================\n    # 翻书声音\n    bgm_audios.append({\n        \"audio_url\": \"https://houht.oss-cn-shanghai.aliyuncs.com/public/booklist/book.MP3\",\n        \"duration\": 2000000,\n        \"start\": 0,\n        \"end\": 2000000\n    })\n    #背景音乐时间线\n    bgm_audios.append({\n        \"audio_url\": \"https://houht.oss-cn-shanghai.aliyuncs.com/public/booklist/bgm2.MP3\",\n        \"duration\": pre_time-2000000,\n        \"start\": 2000000,\n        \"end\": pre_time\n    })\n    #==============\n\n    #开场封面1 2秒  添加特效 模糊，2秒 audio_duration\n    # 结束时间：在翻书转场特效之后 0.5秒\n    imgs1.append({\n            \"image_url\": cover_image,\n            \"width\": 768,\n            \"height\": 1024,\n            \"start\": 0,\n            \"end\": audio_duration+1000000+500000,\n            \"transition\":\"中心切开\",\n            \"transition_duration\":1000000\n        })\n    #开场封面2 翻书动画 2秒  audio_duration\n    imgs2.append({\n            \"image_url\": cover_image,\n            \"width\": 768,\n            \"height\": 1024,\n            \"start\": 0,\n            \"end\": audio_duration+1000000,\n            \"in_animation\": \"翻书\",\n            \"in_animation_duration\": audio_duration,\n            \"transition\":\"中心切开\",\n            \"transition_duration\":1000000\n        })\n    # 背景图，第二个分镜图\n    # imgs1.append({\n    #         \"image_url\": bg_image,\n    #         \"width\": width,\n    #         \"height\": height,\n    #         \"start\": audio_duration+1000000,\n    #         \"end\": pre_time\n    #     })\n    imgs2.append({\n            \"image_url\": bg_image,\n            \"width\": width,\n            \"height\": height,\n            \"start\": audio_duration+1000000,\n            \"end\": pre_time\n        })\n\n\n    effects = []\n    effects.append({\n        \"effect_title\": \"模糊\",\n        \"end\": audio_duration+1000000,  \n        \"start\": 0\n        })\n\n    effects2 = []\n    effects2.append({\n        \"effect_title\": \"星火\",\n        \"end\": pre_time,  \n        \"start\": audio_duration+1000000\n        })\n    # 构建输出对象\n    ret = {\n        \"captions\": json.dumps(params['caption_list']),\n        \"audios\": json.dumps(audios),\n        \"bgm_audios\": json.dumps(bgm_audios),\n        \"imgs1\": json.dumps(imgs1),\n        \"imgs2\": json.dumps(imgs2),\n        \"effects\":json.dumps(effects),\n        \"effects2\":json.dumps(effects2),\n        \"titleCaptions\":json.dumps(title_captions),\n        \"topcaptions\":json.dumps(topcaptions)\n    }\n\n    return ret","inputParameters":[{"input":{"type":"string","value":{"content":"1920","type":"literal"}},"name":"width"},{"input":{"type":"string","value":{"content":"1080","type":"literal"}},"name":"height"},{"input":{"type":"integer","value":{"content":{"blockID":"135573","name":"pre_time","source":"block-output"},"rawMeta":{"type":2},"type":"ref"}},"name":"pre_time"},{"input":{"schema":{"schema":[],"type":"object"},"type":"list","value":{"content":{"blockID":"135573","name":"caption_list","source":"block-output"},"rawMeta":{"type":103},"type":"ref"}},"name":"caption_list"},{"input":{"schema":{"schema":[],"type":"object"},"type":"list","value":{"content":{"blockID":"135573","name":"audio_list","source":"block-output"},"rawMeta":{"type":103},"type":"ref"}},"name":"audio_list"},{"input":{"assistType":2,"type":"string","value":{"content":{"blockID":"100001","name":"pic","source":"block-output"},"rawMeta":{"type":7},"type":"ref"}},"name":"pic"},{"input":{"type":"string","value":{"content":{"blockID":"310628","name":"data.link","source":"block-output"},"rawMeta":{"type":1},"type":"ref"}},"name":"audio_url"},{"input":{"type":"integer","value":{"content":{"blockID":"196678","name":"duration","source":"block-output"},"rawMeta":{"type":2},"type":"ref"}},"name":"audio_duration"},{"input":{"assistType":2,"type":"string","value":{"content":{"blockID":"178517","name":"data","source":"block-output"},"rawMeta":{"type":7},"type":"ref"}},"name":"bg_pic"},{"input":{"type":"string","value":{"content":{"blockID":"100001","name":"title","source":"block-output"},"rawMeta":{"type":1},"type":"ref"}},"name":"title"},{"input":{"type":"string","value":{"content":{"blockID":"137843","name":"output","source":"block-output"},"rawMeta":{"type":1},"type":"ref"}},"name":"toptitle"},{"input":{"type":"string","value":{"content":{"blockID":"100001","name":"bgm","source":"block-output"},"rawMeta":{"type":1},"type":"ref"}},"name":"bgm"}],"language":3,"settingOnError":{"processType":1,"retryTimes":0,"switch":false,"timeoutMs":60000}},"nodeMeta":{"description":"编写代码，处理输入变量来生成返回值","icon":"https://lf3-static.bytednsdoc.com/obj/eden-cn/dvsmryvd_avi_dvsm/ljhwZthlaukjlkulzlp/icon/icon-Code-v2.jpg","subTitle":"代码","title":"组合结构"},"outputs":[{"name":"captions","required":false,"type":"string"},{"name":"audios","required":false,"type":"string"},{"name":"bgm_audios","required":false,"type":"string"},{"name":"imgs1","required":false,"type":"string"},{"name":"imgs2","required":false,"type":"string"},{"name":"effects","required":false,"type":"string"},{"name":"effects2","required":false,"type":"string"},{"name":"titleCaptions","required":false,"type":"string"},{"name":"topcaptions","required":false,"type":"string"}]},"edges":null,"id":"175205","meta":{"position":{"x":1146.4931018605153,"y":873.5865408505922}},"type":"5","_temp":{"bounds":{"x":0,"y":0,"width":0,"height":0}}},{"blocks":[],"data":{"inputs":{"apiParam":null,"inputParameters":[{"input":{"type":"string","value":{"content":{"blockID":"120003","name":"prompt","source":"block-output"},"dependencies":{"variables":null},"inputMode":"","rawMeta":{"type":1},"type":"ref"}},"left":{},"name":"prompt","right":{}}],"modelSetting":{"custom_ratio":{"height":576,"width":1024},"ddim_steps":40,"images_reference":{},"model":8,"ratio":0},"prompt":{"negative_prompt":"","prompt":"{{prompt}}"},"references":[],"settingOnError":{"processType":1,"switch":false,"timeoutMs":60000}},"nodeMeta":{"description":"通过文字描述/添加参考图生成图片","icon":"https://lf3-static.bytednsdoc.com/obj/eden-cn/dvsmryvd_avi_dvsm/ljhwZthlaukjlkulzlp/icon/icon-ImageGeneration-v2.jpg","title":"图像生成_背景图"},"outputs":[{"assistType":2,"input":{},"name":"data","required":false,"type":"string"},{"input":{},"name":"msg","required":false,"type":"string"}],"settings":null,"version":""},"edges":null,"id":"178517","meta":{"position":{"x":-3193.5068981394847,"y":1233.6365408505924}},"type":"16","_temp":{"bounds":{"x":0,"y":0,"width":0,"height":0}}},{"blocks":[{"blocks":[],"data":{"inputs":{"apiParam":[{"input":{"type":"string","value":{"content":"7426655854067367946","type":"literal"}},"name":"apiID"},{"input":{"type":"string","value":{"content":"speech_synthesis","type":"literal"}},"name":"apiName"},{"input":{"type":"string","value":{"content":"7426655854067351562","type":"literal"}},"name":"pluginID"},{"input":{"type":"string","value":{"content":"语音合成","type":"literal"}},"name":"pluginName"},{"input":{"type":"string","value":{"content":"","type":"literal"}},"name":"pluginVersion"},{"input":{"type":"string","value":{"content":"","type":"literal"}},"name":"tips"},{"input":{"type":"string","value":{"content":"","type":"literal"}},"name":"outDocLink"}],"inputDefs":[{"defaultValue":1,"description":"语速，范围是[0.2,3]，默认为1，通常保留一位小数即可, default value is 1","input":{},"name":"speed_ratio","required":false,"type":"float"},{"description":"要合成音频的文本内容","input":{},"name":"text","required":true,"type":"string"},{"assistType":12,"description":"voice id","input":{},"name":"voice_id","required":false,"type":"string"},{"description":"语音语种，非必填，参考 https://bytedance.larkoffice.com/docx/WdDOdiB1BoRyBNxlkXWcn0n3nLc","input":{},"name":"language","required":false,"type":"string"},{"defaultValue":"爽快思思/Skye","description":"音色ID，默认为爽快思思/Skye。详细音色列表参考 https://bytedance.larkoffice.com/docx/WdDOdiB1BoRyBNxlkXWcn0n3nLc, default value is 爽快思思/Skye","input":{},"name":"speaker_id","required":false,"type":"string"}],"inputParameters":[{"input":{"type":"string","value":{"content":{"blockID":"135573","name":"input","source":"block-output"},"rawMeta":{"type":1},"type":"ref"}},"name":"text"},{"input":{"type":"float","value":{"content":1,"rawMeta":{"type":4},"type":"literal"}},"name":"speed_ratio"},{"input":{"assistType":12,"type":"string","value":{"content":"7481299960424644662","rawMeta":{"fileName":"擎苍","type":18},"type":"literal"}},"name":"voice_id"}],"settingOnError":{"processType":1,"retryTimes":0,"timeoutMs":180000}},"nodeMeta":{"description":"根据音色和文本合成音频","icon":"https://lf3-static.bytednsdoc.com/obj/eden-cn/dvsmryvd_avi_dvsm/ljhwZthlaukjlkulzlp/icon/icon-Plugin-v2.jpg","subtitle":"语音合成:speech_synthesis","title":"speech_synthesis"},"outputs":[{"name":"code","required":false,"type":"float"},{"name":"data","required":false,"schema":[{"name":"link","required":false,"type":"string"}],"type":"object"},{"name":"log_id","required":false,"type":"string"},{"name":"msg","required":false,"type":"string"}]},"edges":null,"id":"102982","meta":{"position":{"x":640,"y":0}},"type":"4"},{"blocks":[],"data":{"inputs":{"code":"# 在这里，您可以通过 ‘args’  获取节点中的输入变量，并通过 'ret' 输出结果\n# 'args' 和 'ret' 已经被正确地注入到环境中\n# 下面是一个示例，首先获取节点的全部输入参数params，其次获取其中参数名为‘input’的值：\n# params = args.params; \n# input = params.input;\n# 下面是一个示例，输出一个包含多种数据类型的 'ret' 对象：\n# ret: Output =  { \"name\": ‘小明’, \"hobbies\": [“看书”, “旅游”] };\nimport re\nasync def main(args: Args) -> Output:\n    params = args.params\n    content = params['content']\n    pattern = r'[,，.。！？、；：-]\\s*'\n\n    # 使用re.split()函数根据正则表达式切割文本\n    # re.split()会将匹配到的分隔符从结果中移除\n    texts = re.split(pattern, content)\n\n    # 移除数组中可能存在的空字符串元素\n    texts = [t for t in texts if t]\n    # 构建输出对象\n    ret: Output = {\n        \"texts\": \"\\n\".join(texts)\n    }\n    return ret","inputParameters":[{"input":{"type":"string","value":{"content":{"blockID":"135573","name":"input","source":"block-output"},"rawMeta":{"type":1},"type":"ref"}},"name":"content"}],"language":3,"settingOnError":{"processType":1,"retryTimes":0,"switch":false,"timeoutMs":60000}},"nodeMeta":{"description":"编写代码，处理输入变量来生成返回值","icon":"https://lf3-static.bytednsdoc.com/obj/eden-cn/dvsmryvd_avi_dvsm/ljhwZthlaukjlkulzlp/icon/icon-Code-v2.jpg","subTitle":"代码","title":"代码_分句"},"outputs":[{"name":"texts","required":false,"type":"string"}]},"edges":null,"id":"125088","meta":{"position":{"x":180,"y":0}},"type":"5"},{"blocks":[],"data":{"inputs":{"code":"import json\nimport random\nasync def main(args: Args) -> Output:\n    params = args.params\n\n    #固定参数\n    width = params['width']\n    height = params['height']\n\n    #中间变量\n    captions = params['caption_list']\n    audios = params['audio_list']\n\n    #每次循环的动态参数\n    timelines = params['timelines']\n    audio = params['audio']\n    texts = params['texts']\n    duration = params['duration']\n    \n    #中间变量\n    pre_time = params['pre_time']\n\n\n    # 每段配音计算\n    audios.append({\n        \"audio_url\": audio,\n        \"duration\": int(duration * 1000000),\n        \"start\": pre_time,\n        \"end\": pre_time+int(duration * 1000000),\n        # \"audio_effect\":\"环绕回声\"\n    })\n\n    #计算时长，设置字幕的时长\n    for index2 , obj in enumerate(timelines):\n        captions.append({\n            'text': texts[index2],\n            'start': int(pre_time + obj['start']),\n            'end': int(pre_time + obj['end']),\n            \"in_animation\":\"渐显\",\"out_animation\":\"渐隐\"\n        })\n    # 构建输出对象\n    # 重置pre_time为此次处理的结束时间\n    ret = {\n        \"captions\": captions,\n        \"audios\": audios,\n        \"end_time\":pre_time+int(duration * 1000000)\n    }\n\n    return ret","inputParameters":[{"input":{"type":"string","value":{"content":{"blockID":"102982","name":"data.link","source":"block-output"},"rawMeta":{"type":1},"type":"ref"}},"name":"audio"},{"input":{"schema":{"schema":[{"name":"end","required":false,"type":"integer"},{"name":"start","required":false,"type":"integer"}],"type":"object"},"type":"list","value":{"content":{"blockID":"112407","name":"timelines","source":"block-output"},"rawMeta":{"type":103},"type":"ref"}},"name":"timelines"},{"input":{"schema":{"type":"string"},"type":"list","value":{"content":{"blockID":"112407","name":"texts","source":"block-output"},"rawMeta":{"type":99},"type":"ref"}},"name":"texts"},{"input":{"type":"integer","value":{"content":{"blockID":"135573","name":"pre_time","source":"block-output"},"rawMeta":{"type":2},"type":"ref"}},"name":"pre_time"},{"input":{"schema":{"schema":[],"type":"object"},"type":"list","value":{"content":{"blockID":"135573","name":"audio_list","source":"block-output"},"rawMeta":{"type":103},"type":"ref"}},"name":"audio_list"},{"input":{"schema":{"schema":[],"type":"object"},"type":"list","value":{"content":{"blockID":"135573","name":"caption_list","source":"block-output"},"rawMeta":{"type":103},"type":"ref"}},"name":"caption_list"},{"input":{"type":"string","value":{"content":"1920","rawMeta":{"type":1},"type":"literal"}},"name":"width"},{"input":{"type":"string","value":{"content":"1080","rawMeta":{"type":1},"type":"literal"}},"name":"height"},{"input":{"type":"float","value":{"content":{"blockID":"112407","name":"duration","source":"block-output"},"rawMeta":{"type":4},"type":"ref"}},"name":"duration"}],"language":3,"settingOnError":{"processType":1,"retryTimes":0,"switch":false,"timeoutMs":60000}},"nodeMeta":{"description":"编写代码，处理输入变量来生成返回值","icon":"https://lf3-static.bytednsdoc.com/obj/eden-cn/dvsmryvd_avi_dvsm/ljhwZthlaukjlkulzlp/icon/icon-Code-v2.jpg","subTitle":"代码","title":"代码_素材组合"},"outputs":[{"name":"audios","required":false,"schema":{"schema":[],"type":"object"},"type":"list"},{"name":"captions","required":false,"schema":{"schema":[],"type":"object"},"type":"list"},{"name":"end_time","required":false,"type":"integer"}]},"edges":null,"id":"138362","meta":{"position":{"x":1560,"y":0}},"type":"5"},{"blocks":[],"data":{"inputs":{"inputParameters":[{"left":{"schema":{"schema":[],"type":"object"},"type":"list","value":{"content":{"blockID":"135573","name":"caption_list","source":"block-output"},"rawMeta":{"type":103},"type":"ref"}},"right":{"schema":{"schema":[],"type":"object"},"type":"list","value":{"content":{"blockID":"138362","name":"captions","source":"block-output"},"rawMeta":{"type":103},"type":"ref"}}},{"left":{"schema":{"schema":[],"type":"object"},"type":"list","value":{"content":{"blockID":"135573","name":"audio_list","source":"block-output"},"rawMeta":{"type":103},"type":"ref"}},"right":{"schema":{"schema":[],"type":"object"},"type":"list","value":{"content":{"blockID":"138362","name":"audios","source":"block-output"},"rawMeta":{"type":103},"type":"ref"}}},{"left":{"type":"integer","value":{"content":{"blockID":"135573","name":"pre_time","source":"block-output"},"rawMeta":{"type":2},"type":"ref"}},"right":{"type":"integer","value":{"content":{"blockID":"138362","name":"end_time","source":"block-output"},"rawMeta":{"type":2},"type":"ref"}}}]},"nodeMeta":{"description":"用于重置循环变量的值，使其下次循环使用重置后的值","icon":"https://lf3-static.bytednsdoc.com/obj/eden-cn/dvsmryvd_avi_dvsm/ljhwZthlaukjlkulzlp/icon/icon-LoopSetVariable-v2.jpg","mainColor":"#00B2B2","subTitle":"设置变量","title":"设置变量"}},"edges":null,"id":"169077","meta":{"position":{"x":2020,"y":13}},"type":"20"},{"blocks":[],"data":{"inputs":{"apiParam":[{"input":{"type":"string","value":{"content":"7531810649823952937","rawMeta":{"type":1},"type":"literal"}},"name":"apiID"},{"input":{"type":"string","value":{"content":"align_text_to_audio_v2","rawMeta":{"type":1},"type":"literal"}},"name":"apiName"},{"input":{"type":"string","value":{"content":"7528251903906414638","rawMeta":{"type":1},"type":"literal"}},"name":"pluginID"},{"input":{"type":"string","value":{"content":"字幕音频自动对齐","rawMeta":{"type":1},"type":"literal"}},"name":"pluginName"},{"input":{"type":"string","value":{"content":"","rawMeta":{"type":1},"type":"literal"}},"name":"pluginVersion"},{"input":{"type":"string","value":{"content":"","rawMeta":{"type":1},"type":"literal"}},"name":"tips"},{"input":{"type":"string","value":{"content":"","rawMeta":{"type":1},"type":"literal"}},"name":"outDocLink"}],"inputParameters":[{"input":{"type":"string","value":{"content":{"blockID":"102982","name":"data.link","source":"block-output"},"rawMeta":{"type":1},"type":"ref"}},"name":"audio_url"},{"input":{"type":"string","value":{"content":{"blockID":"135573","name":"input","source":"block-output"},"rawMeta":{"type":1},"type":"ref"}},"name":"text"}],"settingOnError":{"processType":1,"retryTimes":0,"timeoutMs":180000}},"nodeMeta":{"description":"字幕音频自动对齐插件","icon":"https://p3-flow-product-sign.byteimg.com/tos-cn-i-13w3uml6bg/48e6464f24974e919c73ae9167013b1c~tplv-13w3uml6bg-resize:128:128.image?rk3s=2e2596fd&x-expires=1756918663&x-signature=bGWe2LA%2Fnf0k3CCRMqQruA2u7eU%3D","subtitle":"字幕音频自动对齐:align_text_to_audio_v2","title":"align_text_to_audio_v2"},"outputs":[{"name":"duration","required":false,"type":"float"},{"name":"msg","required":false,"type":"string"},{"name":"texts","required":false,"schema":{"type":"string"},"type":"list"},{"name":"timelines","required":false,"schema":{"schema":[{"name":"end","required":false,"type":"integer"},{"name":"start","required":false,"type":"integer"}],"type":"object"},"type":"list"}]},"edges":null,"id":"112407","meta":{"position":{"x":1100,"y":-13.396412456344706}},"type":"4"}],"data":{"inputs":{"inputParameters":[{"input":{"schema":{"type":"string"},"type":"list","value":{"content":{"blockID":"168273","name":"Group3","source":"block-output"},"rawMeta":{"type":99},"type":"ref"}},"name":"input"}],"loopCount":{"type":"integer","value":{"content":"10","type":"literal"}},"loopType":"array","variableParameters":[{"input":{"type":"integer","value":{"content":{"blockID":"196678","name":"nextDuration","source":"block-output"},"rawMeta":{"type":2},"type":"ref"}},"name":"pre_time"},{"input":{"schema":{"schema":[],"type":"object"},"type":"list","value":{"content":{"blockID":"196678","name":"audios","source":"block-output"},"rawMeta":{"type":103},"type":"ref"}},"name":"audio_list"},{"input":{"schema":{"schema":[],"type":"object"},"type":"list","value":{"content":"[]","rawMeta":{"type":103},"type":"literal"}},"name":"caption_list"}]},"nodeMeta":{"description":"用于通过设定循环次数和逻辑，重复执行一系列任务","icon":"https://lf3-static.bytednsdoc.com/obj/eden-cn/dvsmryvd_avi_dvsm/ljhwZthlaukjlkulzlp/icon/icon-Loop-v2.jpg","mainColor":"#00B2B2","subTitle":"循环","title":"循环"},"outputs":[{"input":{"type":"integer","value":{"content":{"blockID":"135573","name":"pre_time","source":"block-output"},"rawMeta":{"type":2},"type":"ref"}},"name":"pre_time"},{"input":{"schema":{"schema":[],"type":"object"},"type":"list","value":{"content":{"blockID":"135573","name":"caption_list","source":"block-output"},"rawMeta":{"type":103},"type":"ref"}},"name":"caption_list"},{"input":{"schema":{"schema":[],"type":"object"},"type":"list","value":{"content":{"blockID":"135573","name":"audio_list","source":"block-output"},"rawMeta":{"type":103},"type":"ref"}},"name":"audio_list"}]},"edges":[{"sourceNodeID":"125088","sourcePortID":"","targetNodeID":"102982"},{"sourceNodeID":"102982","sourcePortID":"","targetNodeID":"112407"},{"sourceNodeID":"135573","sourcePortID":"loop-function-inline-output","targetNodeID":"125088"},{"sourceNodeID":"112407","sourcePortID":"","targetNodeID":"138362"},{"sourceNodeID":"138362","sourcePortID":"","targetNodeID":"169077"},{"sourceNodeID":"169077","sourcePortID":"","targetNodeID":"135573","targetPortID":"loop-function-inline-input"}],"id":"135573","meta":{"canvasPosition":{"x":-1433.5068981394847,"y":1180.2865408505925},"position":{"x":-333.50689813948463,"y":860.5865408505922}},"type":"21","_temp":{"bounds":{"x":0,"y":0,"width":0,"height":0}}},{"blocks":[],"data":{"inputs":{"concatParams":[{"input":{"type":"string","value":{"content":"今天要分享的是《{{String1}}》","rawMeta":{"type":1},"type":"literal"}},"name":"concatResult"},{"input":{"type":"string","value":{"content":"，","rawMeta":{"type":1},"type":"literal"}},"name":"arrayItemConcatChar"},{"input":{"schema":{"schema":[{"name":"label","required":true,"type":"string"},{"name":"value","required":true,"type":"string"},{"name":"isDefault","required":true,"type":"boolean"}],"type":"object"},"type":"list","value":{"content":[{"isDefault":true,"label":"换行","value":"\n"},{"isDefault":true,"label":"制表符","value":"\t"},{"isDefault":true,"label":"句号","value":"。"},{"isDefault":true,"label":"逗号","value":"，"},{"isDefault":true,"label":"分号","value":"；"},{"isDefault":true,"label":"空格","value":" "}],"type":"literal"}},"name":"allArrayItemConcatChars"}],"inputParameters":[{"input":{"type":"string","value":{"content":{"blockID":"100001","name":"title","source":"block-output"},"rawMeta":{"type":1},"type":"ref"}},"name":"String1"}],"method":"concat"},"nodeMeta":{"description":"用于处理多个字符串类型变量的格式","icon":"https://lf3-static.bytednsdoc.com/obj/eden-cn/dvsmryvd_avi_dvsm/ljhwZthlaukjlkulzlp/icon/icon-StrConcat-v2.jpg","mainColor":"#3071F2","subTitle":"文本处理","title":"文本处理_开场白"},"outputs":[{"name":"output","required":true,"type":"string"}]},"edges":null,"id":"168602","meta":{"position":{"x":-3193.5068981394847,"y":535.0365408505925}},"type":"15","_temp":{"bounds":{"x":0,"y":0,"width":0,"height":0}}},{"blocks":[],"data":{"inputs":{"apiParam":[{"input":{"type":"string","value":{"content":"7426655854067367946","type":"literal"}},"name":"apiID"},{"input":{"type":"string","value":{"content":"speech_synthesis","type":"literal"}},"name":"apiName"},{"input":{"type":"string","value":{"content":"7426655854067351562","type":"literal"}},"name":"pluginID"},{"input":{"type":"string","value":{"content":"语音合成","type":"literal"}},"name":"pluginName"},{"input":{"type":"string","value":{"content":"","type":"literal"}},"name":"pluginVersion"},{"input":{"type":"string","value":{"content":"","type":"literal"}},"name":"tips"},{"input":{"type":"string","value":{"content":"","type":"literal"}},"name":"outDocLink"}],"inputDefs":[{"defaultValue":1,"description":"语速，范围是[0.2,3]，默认为1，通常保留一位小数即可, default value is 1","input":{},"name":"speed_ratio","required":false,"type":"float"},{"description":"要合成音频的文本内容","input":{},"name":"text","required":true,"type":"string"},{"assistType":12,"description":"voice id","input":{},"name":"voice_id","required":false,"type":"string"},{"description":"语音语种，非必填，参考 https://bytedance.larkoffice.com/docx/WdDOdiB1BoRyBNxlkXWcn0n3nLc","input":{},"name":"language","required":false,"type":"string"},{"defaultValue":"爽快思思/Skye","description":"音色ID，默认为爽快思思/Skye。详细音色列表参考 https://bytedance.larkoffice.com/docx/WdDOdiB1BoRyBNxlkXWcn0n3nLc, default value is 爽快思思/Skye","input":{},"name":"speaker_id","required":false,"type":"string"}],"inputParameters":[{"input":{"type":"string","value":{"content":{"blockID":"168602","name":"output","source":"block-output"},"rawMeta":{"type":1},"type":"ref"}},"name":"text"},{"input":{"type":"float","value":{"content":1,"rawMeta":{"type":4},"type":"literal"}},"name":"speed_ratio"},{"input":{"assistType":12,"type":"string","value":{"content":"7481299960424644662","rawMeta":{"fileName":"擎苍","type":18},"type":"literal"}},"name":"voice_id"}],"settingOnError":{"processType":1,"retryTimes":0,"timeoutMs":180000}},"nodeMeta":{"description":"根据音色和文本合成音频","icon":"https://lf3-static.bytednsdoc.com/obj/eden-cn/dvsmryvd_avi_dvsm/ljhwZthlaukjlkulzlp/icon/icon-Plugin-v2.jpg","subtitle":"语音合成:speech_synthesis","title":"speech_synthesis_1"},"outputs":[{"name":"code","required":false,"type":"float"},{"name":"data","required":false,"schema":[{"name":"link","required":false,"type":"string"}],"type":"object"},{"name":"log_id","required":false,"type":"string"},{"name":"msg","required":false,"type":"string"}]},"edges":null,"id":"310628","meta":{"position":{"x":-2733.5068981394847,"y":873.5865408505922}},"type":"4","_temp":{"bounds":{"x":0,"y":0,"width":0,"height":0}}},{"blocks":[],"data":{"inputs":{"apiParam":[{"input":{"type":"string","value":{"content":"7417655779794157603","rawMeta":{"type":1},"type":"literal"}},"name":"apiID"},{"input":{"type":"string","value":{"content":"get_audio_duration","rawMeta":{"type":1},"type":"literal"}},"name":"apiName"},{"input":{"type":"string","value":{"content":"7417655779794141219","rawMeta":{"type":1},"type":"literal"}},"name":"pluginID"},{"input":{"type":"string","value":{"content":"获取音频时长","rawMeta":{"type":1},"type":"literal"}},"name":"pluginName"},{"input":{"type":"string","value":{"content":"","rawMeta":{"type":1},"type":"literal"}},"name":"pluginVersion"},{"input":{"type":"string","value":{"content":"","rawMeta":{"type":1},"type":"literal"}},"name":"tips"},{"input":{"type":"string","value":{"content":"","rawMeta":{"type":1},"type":"literal"}},"name":"outDocLink"}],"inputParameters":[{"input":{"type":"string","value":{"content":{"blockID":"310628","name":"data.link","source":"block-output"},"rawMeta":{"type":1},"type":"ref"}},"name":"mp3_url"}],"settingOnError":{"processType":1,"retryTimes":0,"timeoutMs":180000}},"nodeMeta":{"description":"输入音频链接返回音频时长，单位秒","icon":"https://p9-flow-product-sign.byteimg.com/tos-cn-i-13w3uml6bg/bae579eb93ab45ae881edc679ed2696a~tplv-13w3uml6bg-resize:128:128.image?rk3s=2e2596fd&x-expires=1747324158&x-signature=G6LJ9U%2BMKgnIT3TzkqAjNCJdcwY%3D","subtitle":"获取音频时长:get_audio_duration","title":"get_audio_duration"},"outputs":[{"name":"duration","required":false,"type":"float"},{"name":"message","required":false,"type":"string"}]},"edges":null,"id":"186834","meta":{"position":{"x":-2273.5068981394847,"y":861.5865408505922}},"type":"4","_temp":{"bounds":{"x":0,"y":0,"width":0,"height":0}}},{"blocks":[],"data":{"inputs":{"apiParam":[{"input":{"type":"string","value":{"content":"7457837925833834536","rawMeta":{"type":1},"type":"literal"}},"name":"apiID"},{"input":{"type":"string","value":{"content":"add_audios","rawMeta":{"type":1},"type":"literal"}},"name":"apiName"},{"input":{"type":"string","value":{"content":"7457837925833801768","rawMeta":{"type":1},"type":"literal"}},"name":"pluginID"},{"input":{"type":"string","value":{"content":"视频合成_剪映小助手","rawMeta":{"type":1},"type":"literal"}},"name":"pluginName"},{"input":{"type":"string","value":{"content":"","rawMeta":{"type":1},"type":"literal"}},"name":"pluginVersion"},{"input":{"type":"string","value":{"content":"","rawMeta":{"type":1},"type":"literal"}},"name":"tips"},{"input":{"type":"string","value":{"content":"","rawMeta":{"type":1},"type":"literal"}},"name":"outDocLink"}],"inputParameters":[{"input":{"type":"string","value":{"content":{"blockID":"175205","name":"bgm_audios","source":"block-output"},"rawMeta":{"type":1},"type":"ref"}},"name":"audio_infos"},{"input":{"type":"string","value":{"content":{"blockID":"119835","name":"draft_url","source":"block-output"},"rawMeta":{"type":1},"type":"ref"}},"name":"draft_url"}],"settingOnError":{"processType":1,"retryTimes":0,"timeoutMs":180000}},"nodeMeta":{"description":"批量添加音频","icon":"https://p6-flow-product-sign.byteimg.com/tos-cn-i-13w3uml6bg/512a936fbfc547c9a0fafa993e6cba13~tplv-13w3uml6bg-resize:128:128.image?rk3s=2e2596fd&x-expires=1747326459&x-signature=xZj%2BE7RYFmKcxyvDcOx7Xv%2Bfdbc%3D","subtitle":"视频合成_剪映小助手:add_audios","title":"add_audios_bgm"},"outputs":[{"name":"audio_ids","required":false,"schema":{"type":"string"},"type":"list"},{"name":"draft_url","required":false,"type":"string"},{"name":"track_id","required":false,"type":"string"}]},"edges":null,"id":"178582","meta":{"position":{"x":2066.4931018605153,"y":873.5865408505922}},"type":"4","_temp":{"bounds":{"x":0,"y":0,"width":0,"height":0}}},{"blocks":[],"data":{"inputs":{"apiParam":[{"input":{"type":"string","value":{"content":"7457837925833883688","rawMeta":{"type":1},"type":"literal"}},"name":"apiID"},{"input":{"type":"string","value":{"content":"add_images","rawMeta":{"type":1},"type":"literal"}},"name":"apiName"},{"input":{"type":"string","value":{"content":"7457837925833801768","rawMeta":{"type":1},"type":"literal"}},"name":"pluginID"},{"input":{"type":"string","value":{"content":"视频合成_剪映小助手","rawMeta":{"type":1},"type":"literal"}},"name":"pluginName"},{"input":{"type":"string","value":{"content":"","rawMeta":{"type":1},"type":"literal"}},"name":"pluginVersion"},{"input":{"type":"string","value":{"content":"","rawMeta":{"type":1},"type":"literal"}},"name":"tips"},{"input":{"type":"string","value":{"content":"","rawMeta":{"type":1},"type":"literal"}},"name":"outDocLink"}],"inputParameters":[{"input":{"type":"string","value":{"content":{"blockID":"119835","name":"draft_url","source":"block-output"},"rawMeta":{"type":1},"type":"ref"}},"name":"draft_url"},{"input":{"type":"string","value":{"content":{"blockID":"175205","name":"imgs1","source":"block-output"},"rawMeta":{"type":1},"type":"ref"}},"name":"image_infos"},{"input":{"type":"float","value":{"content":3.5,"rawMeta":{"type":4},"type":"literal"}},"name":"scale_x"},{"input":{"type":"float","value":{"content":3.5,"rawMeta":{"type":4},"type":"literal"}},"name":"scale_y"}],"settingOnError":{"processType":1,"retryTimes":0,"timeoutMs":180000}},"nodeMeta":{"description":"批量添加图片","icon":"https://p6-flow-product-sign.byteimg.com/tos-cn-i-13w3uml6bg/512a936fbfc547c9a0fafa993e6cba13~tplv-13w3uml6bg-resize:128:128.image?rk3s=2e2596fd&x-expires=1747326557&x-signature=XYt5sZSzrthxo%2Fzf6X7UTTe9Qgc%3D","subtitle":"视频合成_剪映小助手:add_images","title":"add_images_cover1"},"outputs":[{"name":"image_ids","required":false,"schema":{"type":"string"},"type":"list"},{"name":"segment_ids","required":false,"schema":{"type":"string"},"type":"list"},{"name":"segment_infos","required":false,"schema":{"schema":[{"name":"id","required":false,"type":"string"},{"name":"start","required":false,"type":"integer"},{"name":"end","required":false,"type":"integer"}],"type":"object"},"type":"list"},{"name":"track_id","required":false,"type":"string"},{"name":"draft_url","required":false,"type":"string"}]},"edges":null,"id":"174538","meta":{"position":{"x":2986.4931018605153,"y":873.5865408505922}},"type":"4","_temp":{"bounds":{"x":0,"y":0,"width":0,"height":0}}},{"blocks":[],"data":{"inputs":{"code":"async def main(args: Args) -> Output:\n    params = args.params\n    # 构建输出对象\n    # 每段配音计算\n    audios = []\n    duration = params['duration']\n    audios.append({\n        \"audio_url\": params['link'],\n        \"duration\": int(duration * 1000000),\n        \"start\": 0,\n        \"end\": int(duration * 1000000),\n    })\n    #增加1s的间隔时间\n    ret: Output = {\n        \"audios\": audios,\n        \"duration\":int(duration*1000000),\n        \"nextDuration\":int(duration*1000000)+1000000,\n    }\n    return ret","inputParameters":[{"input":{"type":"float","value":{"content":{"blockID":"186834","name":"duration","source":"block-output"},"rawMeta":{"type":4},"type":"ref"}},"name":"duration"},{"input":{"type":"string","value":{"content":{"blockID":"310628","name":"data.link","source":"block-output"},"rawMeta":{"type":1},"type":"ref"}},"name":"link"}],"language":3,"settingOnError":{"processType":1,"retryTimes":0,"switch":false,"timeoutMs":60000}},"nodeMeta":{"description":"计算开场音频时间线","icon":"https://lf3-static.bytednsdoc.com/obj/eden-cn/dvsmryvd_avi_dvsm/ljhwZthlaukjlkulzlp/icon/icon-Code-v2.jpg","subTitle":"代码","title":"代码"},"outputs":[{"name":"duration","required":false,"type":"integer"},{"name":"nextDuration","required":false,"type":"integer"},{"name":"audios","required":false,"schema":{"schema":[],"type":"object"},"type":"list"}]},"edges":null,"id":"196678","meta":{"position":{"x":-1813.5068981394847,"y":861.5865408505922}},"type":"5","_temp":{"bounds":{"x":0,"y":0,"width":0,"height":0}}},{"blocks":[],"data":{"inputs":{"apiParam":[{"input":{"type":"string","value":{"content":"7466630948491231268","rawMeta":{"type":1},"type":"literal"}},"name":"apiID"},{"input":{"type":"string","value":{"content":"add_effects","rawMeta":{"type":1},"type":"literal"}},"name":"apiName"},{"input":{"type":"string","value":{"content":"7457837925833801768","rawMeta":{"type":1},"type":"literal"}},"name":"pluginID"},{"input":{"type":"string","value":{"content":"视频合成_剪映小助手","rawMeta":{"type":1},"type":"literal"}},"name":"pluginName"},{"input":{"type":"string","value":{"content":"","rawMeta":{"type":1},"type":"literal"}},"name":"pluginVersion"},{"input":{"type":"string","value":{"content":"","rawMeta":{"type":1},"type":"literal"}},"name":"tips"},{"input":{"type":"string","value":{"content":"","rawMeta":{"type":1},"type":"literal"}},"name":"outDocLink"}],"inputParameters":[{"input":{"type":"string","value":{"content":{"blockID":"119835","name":"draft_url","source":"block-output"},"rawMeta":{"type":1},"type":"ref"}},"name":"draft_url"},{"input":{"type":"string","value":{"content":{"blockID":"175205","name":"effects","source":"block-output"},"rawMeta":{"type":1},"type":"ref"}},"name":"effect_infos"}],"settingOnError":{"processType":1,"retryTimes":0,"timeoutMs":180000}},"nodeMeta":{"description":"添加特效","icon":"https://p3-flow-product-sign.byteimg.com/tos-cn-i-13w3uml6bg/512a936fbfc547c9a0fafa993e6cba13~tplv-13w3uml6bg-resize:128:128.image?rk3s=2e2596fd&x-expires=1747327128&x-signature=i%2BsFQdya55eMEkK2EMX1lDms%2B88%3D","subtitle":"视频合成_剪映小助手:add_effects","title":"add_effects"},"outputs":[{"name":"segment_ids","required":false,"schema":{"type":"string"},"type":"list"},{"name":"track_id","required":false,"type":"string"},{"name":"draft_url","required":false,"type":"string"},{"name":"effect_ids","required":false,"schema":{"type":"string"},"type":"list"}]},"edges":null,"id":"177705","meta":{"position":{"x":3446.4931018605153,"y":873.5865408505922}},"type":"4","_temp":{"bounds":{"x":0,"y":0,"width":0,"height":0}}},{"blocks":[],"data":{"inputs":{"apiParam":[{"input":{"type":"string","value":{"content":"7466630948491231268","rawMeta":{"type":1},"type":"literal"}},"name":"apiID"},{"input":{"type":"string","value":{"content":"add_effects","rawMeta":{"type":1},"type":"literal"}},"name":"apiName"},{"input":{"type":"string","value":{"content":"7457837925833801768","rawMeta":{"type":1},"type":"literal"}},"name":"pluginID"},{"input":{"type":"string","value":{"content":"视频合成_剪映小助手","rawMeta":{"type":1},"type":"literal"}},"name":"pluginName"},{"input":{"type":"string","value":{"content":"","rawMeta":{"type":1},"type":"literal"}},"name":"pluginVersion"},{"input":{"type":"string","value":{"content":"","rawMeta":{"type":1},"type":"literal"}},"name":"tips"},{"input":{"type":"string","value":{"content":"","rawMeta":{"type":1},"type":"literal"}},"name":"outDocLink"}],"inputParameters":[{"input":{"type":"string","value":{"content":{"blockID":"119835","name":"draft_url","source":"block-output"},"rawMeta":{"type":1},"type":"ref"}},"name":"draft_url"},{"input":{"type":"string","value":{"content":{"blockID":"175205","name":"effects2","source":"block-output"},"rawMeta":{"type":1},"type":"ref"}},"name":"effect_infos"}],"settingOnError":{"processType":1,"retryTimes":0,"timeoutMs":180000}},"nodeMeta":{"description":"添加特效","icon":"https://p3-flow-product-sign.byteimg.com/tos-cn-i-13w3uml6bg/512a936fbfc547c9a0fafa993e6cba13~tplv-13w3uml6bg-resize:128:128.image?rk3s=2e2596fd&x-expires=1747327128&x-signature=i%2BsFQdya55eMEkK2EMX1lDms%2B88%3D","subtitle":"视频合成_剪映小助手:add_effects","title":"add_effects_1"},"outputs":[{"name":"segment_ids","required":false,"schema":{"type":"string"},"type":"list"},{"name":"track_id","required":false,"type":"string"},{"name":"draft_url","required":false,"type":"string"},{"name":"effect_ids","required":false,"schema":{"type":"string"},"type":"list"}]},"edges":null,"id":"124207","meta":{"position":{"x":4366.493101860516,"y":873.5865408505922}},"type":"4","_temp":{"bounds":{"x":0,"y":0,"width":0,"height":0}}},{"blocks":[],"data":{"inputs":{"apiParam":[{"input":{"type":"string","value":{"content":"7457837925833850920","rawMeta":{"type":1},"type":"literal"}},"name":"apiID"},{"input":{"type":"string","value":{"content":"add_captions","rawMeta":{"type":1},"type":"literal"}},"name":"apiName"},{"input":{"type":"string","value":{"content":"7457837925833801768","rawMeta":{"type":1},"type":"literal"}},"name":"pluginID"},{"input":{"type":"string","value":{"content":"视频合成_剪映小助手","rawMeta":{"type":1},"type":"literal"}},"name":"pluginName"},{"input":{"type":"string","value":{"content":"","rawMeta":{"type":1},"type":"literal"}},"name":"pluginVersion"},{"input":{"type":"string","value":{"content":"","rawMeta":{"type":1},"type":"literal"}},"name":"tips"},{"input":{"type":"string","value":{"content":"","rawMeta":{"type":1},"type":"literal"}},"name":"outDocLink"}],"inputParameters":[{"input":{"type":"string","value":{"content":{"blockID":"175205","name":"titleCaptions","source":"block-output"},"rawMeta":{"type":1},"type":"ref"}},"name":"captions"},{"input":{"type":"string","value":{"content":{"blockID":"119835","name":"draft_url","source":"block-output"},"rawMeta":{"type":1},"type":"ref"}},"name":"draft_url"},{"input":{"type":"integer","value":{"content":1,"rawMeta":{"type":2},"type":"literal"}},"name":"alignment"},{"input":{"type":"string","value":{"content":"优设标题黑","rawMeta":{"type":1},"type":"literal"}},"name":"font"},{"input":{"type":"integer","value":{"content":50,"rawMeta":{"type":2},"type":"literal"}},"name":"font_size"},{"input":{"type":"float","value":{"content":2,"rawMeta":{"type":4},"type":"literal"}},"name":"letter_spacing"},{"input":{"type":"string","value":{"content":"#aa1314","rawMeta":{"type":1},"type":"literal"}},"name":"text_color"}],"settingOnError":{"processType":1,"retryTimes":0,"timeoutMs":180000}},"nodeMeta":{"description":"批量添加字幕","icon":"https://p6-flow-product-sign.byteimg.com/tos-cn-i-13w3uml6bg/512a936fbfc547c9a0fafa993e6cba13~tplv-13w3uml6bg-resize:128:128.image?rk3s=2e2596fd&x-expires=1747331738&x-signature=j4Wk20xjKgtGOYGeqtW9tj%2BJDC0%3D","subtitle":"视频合成_剪映小助手:add_captions","title":"add_captions_1"},"outputs":[{"name":"track_id","required":false,"type":"string"},{"name":"draft_url","required":false,"type":"string"},{"name":"segment_ids","required":false,"schema":{"type":"string"},"type":"list"},{"name":"segment_infos","required":false,"schema":{"schema":[{"name":"end","required":false,"type":"integer"},{"name":"id","required":false,"type":"string"},{"name":"start","required":false,"type":"integer"}],"type":"object"},"type":"list"},{"name":"text_ids","required":false,"schema":{"type":"string"},"type":"list"}]},"edges":null,"id":"195903","meta":{"position":{"x":5286.493101860516,"y":653.8865408505924}},"type":"4","_temp":{"bounds":{"x":0,"y":0,"width":0,"height":0}}},{"blocks":[],"data":{"inputs":{"branches":[{"condition":{"conditions":[{"left":{"input":{"type":"string","value":{"content":{"blockID":"100001","name":"title","source":"block-output"},"type":"ref"}}},"operator":5,"right":{"input":{"type":"integer","value":{"content":3,"rawMeta":{"type":2},"type":"literal"}}}}],"logic":2}},{"condition":{"conditions":[{"left":{"input":{"type":"string","value":{"content":{"blockID":"100001","name":"title","source":"block-output"},"type":"ref"}}},"operator":5,"right":{"input":{"type":"integer","value":{"content":6,"rawMeta":{"type":2},"type":"literal"}}}}],"logic":2}}]},"nodeMeta":{"description":"连接多个下游分支，若设定的条件成立则仅运行对应的分支，若均不成立则只运行“否则”分支","icon":"https://lf3-static.bytednsdoc.com/obj/eden-cn/dvsmryvd_avi_dvsm/ljhwZthlaukjlkulzlp/icon/icon-Condition-v2.jpg","mainColor":"#00B2B2","subTitle":"选择器","title":"选择器"}},"edges":null,"id":"110750","meta":{"position":{"x":4826.493101860516,"y":841.2865408505925}},"type":"8","_temp":{"bounds":{"x":0,"y":0,"width":0,"height":0}}},{"blocks":[],"data":{"inputs":{"apiParam":[{"input":{"type":"string","value":{"content":"7457837925833850920","rawMeta":{"type":1},"type":"literal"}},"name":"apiID"},{"input":{"type":"string","value":{"content":"add_captions","rawMeta":{"type":1},"type":"literal"}},"name":"apiName"},{"input":{"type":"string","value":{"content":"7457837925833801768","rawMeta":{"type":1},"type":"literal"}},"name":"pluginID"},{"input":{"type":"string","value":{"content":"视频合成_剪映小助手","rawMeta":{"type":1},"type":"literal"}},"name":"pluginName"},{"input":{"type":"string","value":{"content":"","rawMeta":{"type":1},"type":"literal"}},"name":"pluginVersion"},{"input":{"type":"string","value":{"content":"","rawMeta":{"type":1},"type":"literal"}},"name":"tips"},{"input":{"type":"string","value":{"content":"","rawMeta":{"type":1},"type":"literal"}},"name":"outDocLink"}],"inputParameters":[{"input":{"type":"string","value":{"content":{"blockID":"175205","name":"titleCaptions","source":"block-output"},"rawMeta":{"type":1},"type":"ref"}},"name":"captions"},{"input":{"type":"string","value":{"content":{"blockID":"119835","name":"draft_url","source":"block-output"},"rawMeta":{"type":1},"type":"ref"}},"name":"draft_url"},{"input":{"type":"integer","value":{"content":1,"rawMeta":{"type":2},"type":"literal"}},"name":"alignment"},{"input":{"type":"string","value":{"content":"优设标题黑","rawMeta":{"type":1},"type":"literal"}},"name":"font"},{"input":{"type":"integer","value":{"content":35,"rawMeta":{"type":2},"type":"literal"}},"name":"font_size"},{"input":{"type":"float","value":{"content":2,"rawMeta":{"type":4},"type":"literal"}},"name":"letter_spacing"},{"input":{"type":"string","value":{"content":"#aa1314","rawMeta":{"type":1},"type":"literal"}},"name":"text_color"}],"settingOnError":{"processType":1,"retryTimes":0,"timeoutMs":180000}},"nodeMeta":{"description":"批量添加字幕","icon":"https://p6-flow-product-sign.byteimg.com/tos-cn-i-13w3uml6bg/512a936fbfc547c9a0fafa993e6cba13~tplv-13w3uml6bg-resize:128:128.image?rk3s=2e2596fd&x-expires=1747331738&x-signature=j4Wk20xjKgtGOYGeqtW9tj%2BJDC0%3D","subtitle":"视频合成_剪映小助手:add_captions","title":"add_captions_2"},"outputs":[{"name":"track_id","required":false,"type":"string"},{"name":"draft_url","required":false,"type":"string"},{"name":"segment_ids","required":false,"schema":{"type":"string"},"type":"list"},{"name":"segment_infos","required":false,"schema":{"schema":[{"name":"end","required":false,"type":"integer"},{"name":"id","required":false,"type":"string"},{"name":"start","required":false,"type":"integer"}],"type":"object"},"type":"list"},{"name":"text_ids","required":false,"schema":{"type":"string"},"type":"list"}]},"edges":null,"id":"108685","meta":{"position":{"x":5286.493101860516,"y":867.5865408505922}},"type":"4","_temp":{"bounds":{"x":0,"y":0,"width":0,"height":0}}},{"blocks":[],"data":{"inputs":{"apiParam":[{"input":{"type":"string","value":{"content":"7417655779794157603","rawMeta":{"type":1},"type":"literal"}},"name":"apiID"},{"input":{"type":"string","value":{"content":"get_audio_duration","rawMeta":{"type":1},"type":"literal"}},"name":"apiName"},{"input":{"type":"string","value":{"content":"7417655779794141219","rawMeta":{"type":1},"type":"literal"}},"name":"pluginID"},{"input":{"type":"string","value":{"content":"获取音频时长","rawMeta":{"type":1},"type":"literal"}},"name":"pluginName"},{"input":{"type":"string","value":{"content":"","rawMeta":{"type":1},"type":"literal"}},"name":"pluginVersion"},{"input":{"type":"string","value":{"content":"","rawMeta":{"type":1},"type":"literal"}},"name":"tips"},{"input":{"type":"string","value":{"content":"","rawMeta":{"type":1},"type":"literal"}},"name":"outDocLink"}],"inputParameters":[{"input":{"type":"string","value":{"content":{"blockID":"100001","name":"bgm","source":"block-output"},"rawMeta":{"type":1},"type":"ref"}},"name":"mp3_url"}],"settingOnError":{"processType":1,"retryTimes":0,"timeoutMs":180000}},"nodeMeta":{"description":"输入音频链接返回音频时长，单位秒","icon":"https://p26-flow-product-sign.byteimg.com/tos-cn-i-13w3uml6bg/bae579eb93ab45ae881edc679ed2696a~tplv-13w3uml6bg-resize:128:128.image?rk3s=2e2596fd&x-expires=1747333403&x-signature=KYUoYRLQtft44nzr3XabIsTjRtA%3D","subtitle":"获取音频时长:get_audio_duration","title":"get_audio_duration_bgm"},"outputs":[{"name":"message","required":false,"type":"string"},{"name":"duration","required":false,"type":"float"}]},"edges":null,"id":"101419","meta":{"position":{"x":-3193.5068981394847,"y":748.7365408505923}},"type":"4","_temp":{"bounds":{"x":0,"y":0,"width":0,"height":0}}},{"blocks":[],"data":{"inputs":{"note":"[{\"type\":\"heading-one\",\"children\":[{\"text\":\"获取前面部分开篇书名音频 \",\"type\":\"text\"}]}]","schemaType":"slate"},"size":{"height":150,"width":240}},"edges":null,"id":"149363","meta":{"position":{"x":-2273.5068981394847,"y":1094.2865408505925}},"type":"31","_temp":{"bounds":{"x":0,"y":0,"width":0,"height":0}}},{"blocks":[],"data":{"inputs":{"branches":[{"condition":{"conditions":[{"left":{"input":{"type":"string","value":{"content":{"blockID":"100001","name":"content","source":"block-output"},"type":"ref"}}},"operator":9}],"logic":2}}]},"nodeMeta":{"description":"连接多个下游分支，若设定的条件成立则仅运行对应的分支，若均不成立则只运行“否则”分支","icon":"https://lf3-static.bytednsdoc.com/obj/eden-cn/dvsmryvd_avi_dvsm/ljhwZthlaukjlkulzlp/icon/icon-Condition-v2.jpg","mainColor":"#00B2B2","subTitle":"选择器","title":"选择器_1"}},"edges":null,"id":"180385","meta":{"position":{"x":-5033.506898139484,"y":847.9365408505923}},"type":"8","_temp":{"bounds":{"x":0,"y":0,"width":0,"height":0}}},{"blocks":[],"data":{"inputs":{"fcParamVar":{"knowledgeFCParam":{}},"inputParameters":[{"input":{"type":"string","value":{"content":{"blockID":"100001","name":"title","source":"block-output"},"rawMeta":{"type":1},"type":"ref"}},"name":"title"},{"input":{"type":"string","value":{"content":{"blockID":"100001","name":"content","source":"block-output"},"rawMeta":{"type":1},"type":"ref"}},"name":"content"}],"llmParam":[{"input":{"type":"float","value":{"content":"0.8","rawMeta":{"type":4},"type":"literal"}},"name":"temperature"},{"input":{"type":"integer","value":{"content":"4096","rawMeta":{"type":2},"type":"literal"}},"name":"maxTokens"},{"input":{"type":"integer","value":{"content":"2","rawMeta":{"type":2},"type":"literal"}},"name":"responseFormat"},{"input":{"type":"string","value":{"content":"豆包·1.5·Pro·32k","rawMeta":{"type":1},"type":"literal"}},"name":"modleName"},{"input":{"type":"integer","value":{"content":"1737521813","rawMeta":{"type":2},"type":"literal"}},"name":"modelType"},{"input":{"type":"string","value":{"content":"balance","rawMeta":{"type":1},"type":"literal"}},"name":"generationDiversity"},{"input":{"type":"string","value":{"content":"标题：{{title}}\n书评文案：{{content}}","rawMeta":{"type":1},"type":"literal"}},"name":"prompt"},{"input":{"type":"boolean","value":{"content":false,"rawMeta":{"type":3},"type":"literal"}},"name":"enableChatHistory"},{"input":{"type":"integer","value":{"content":"3","rawMeta":{"type":2},"type":"literal"}},"name":"chatHistoryRound"},{"input":{"type":"string","value":{"content":"请根据用户输入的书籍名称和书评文案，按如下要求进行处理。\n使用合理分段，每段文字不超过300字\n最终输出，分段数组，标题、作者信息","rawMeta":{"type":1},"type":"literal"}},"name":"systemPrompt"},{"input":{"type":"string","value":{"content":"","rawMeta":{"type":1},"type":"literal"}},"name":"stableSystemPrompt"},{"input":{"type":"boolean","value":{"content":false,"rawMeta":{"type":3},"type":"literal"}},"name":"canContinue"}],"settingOnError":{"processType":1,"retryTimes":0,"switch":false,"timeoutMs":600000}},"nodeMeta":{"description":"调用大语言模型,使用变量和提示词生成回复","icon":"https://lf3-static.bytednsdoc.com/obj/eden-cn/dvsmryvd_avi_dvsm/ljhwZthlaukjlkulzlp/icon/icon-LLM-v2.jpg","subTitle":"大模型","title":"大模型_1"},"outputs":[{"name":"title","required":false,"type":"string"},{"name":"author","required":false,"type":"string"},{"name":"contentList","required":false,"schema":{"type":"string"},"type":"list"}],"version":"3"},"edges":null,"id":"137312","meta":{"position":{"x":-4573.506898139484,"y":1020.9365408505926}},"type":"3","_temp":{"bounds":{"x":0,"y":0,"width":0,"height":0}}},{"blocks":[],"data":{"inputs":{"mergeGroups":[{"name":"Group1","variables":[{"type":"string","value":{"content":{"blockID":"176492","name":"title","source":"block-output"},"rawMeta":{"type":1},"type":"ref"}},{"type":"string","value":{"content":{"blockID":"137312","name":"title","source":"block-output"},"rawMeta":{"type":1},"type":"ref"}}]},{"name":"Group2","variables":[{"type":"string","value":{"content":{"blockID":"176492","name":"author","source":"block-output"},"rawMeta":{"type":1},"type":"ref"}},{"type":"string","value":{"content":{"blockID":"137312","name":"author","source":"block-output"},"rawMeta":{"type":1},"type":"ref"}}]},{"name":"Group3","variables":[{"schema":{"type":"string"},"type":"list","value":{"content":{"blockID":"176492","name":"contentList","source":"block-output"},"rawMeta":{"type":99},"type":"ref"}},{"schema":{"type":"string"},"type":"list","value":{"content":{"blockID":"137312","name":"contentList","source":"block-output"},"rawMeta":{"type":99},"type":"ref"}}]}]},"nodeMeta":{"description":"对多个分支的输出进行聚合处理","icon":"https://lf3-static.bytednsdoc.com/obj/eden-cn/dvsmryvd_avi_dvsm/ljhwZthlaukjlkulzlp/icon/VariableMerge-icon.jpg","mainColor":"#00B2B2","subTitle":"变量聚合","title":"变量聚合"},"outputs":[{"name":"Group1","type":"string"},{"name":"Group2","type":"string"},{"name":"Group3","schema":{"type":"string"},"type":"list"}]},"edges":null,"id":"168273","meta":{"position":{"x":-4113.506898139484,"y":799.5865408505922}},"type":"32","_temp":{"bounds":{"x":0,"y":0,"width":0,"height":0}}},{"blocks":[],"data":{"inputs":{"apiParam":[{"input":{"type":"string","value":{"content":"7457837925833850920","rawMeta":{"type":1},"type":"literal"}},"name":"apiID"},{"input":{"type":"string","value":{"content":"add_captions","rawMeta":{"type":1},"type":"literal"}},"name":"apiName"},{"input":{"type":"string","value":{"content":"7457837925833801768","rawMeta":{"type":1},"type":"literal"}},"name":"pluginID"},{"input":{"type":"string","value":{"content":"视频合成_剪映小助手","rawMeta":{"type":1},"type":"literal"}},"name":"pluginName"},{"input":{"type":"string","value":{"content":"","rawMeta":{"type":1},"type":"literal"}},"name":"pluginVersion"},{"input":{"type":"string","value":{"content":"","rawMeta":{"type":1},"type":"literal"}},"name":"tips"},{"input":{"type":"string","value":{"content":"","rawMeta":{"type":1},"type":"literal"}},"name":"outDocLink"}],"inputParameters":[{"input":{"type":"string","value":{"content":{"blockID":"175205","name":"titleCaptions","source":"block-output"},"rawMeta":{"type":1},"type":"ref"}},"name":"captions"},{"input":{"type":"string","value":{"content":{"blockID":"119835","name":"draft_url","source":"block-output"},"rawMeta":{"type":1},"type":"ref"}},"name":"draft_url"},{"input":{"type":"integer","value":{"content":1,"rawMeta":{"type":2},"type":"literal"}},"name":"alignment"},{"input":{"type":"string","value":{"content":"优设标题黑","rawMeta":{"type":1},"type":"literal"}},"name":"font"},{"input":{"type":"integer","value":{"content":30,"rawMeta":{"type":2},"type":"literal"}},"name":"font_size"},{"input":{"type":"float","value":{"content":2,"rawMeta":{"type":4},"type":"literal"}},"name":"letter_spacing"},{"input":{"type":"string","value":{"content":"#aa1314","rawMeta":{"type":1},"type":"literal"}},"name":"text_color"}],"settingOnError":{"processType":1,"retryTimes":0,"timeoutMs":180000}},"nodeMeta":{"description":"批量添加字幕","icon":"https://p6-flow-product-sign.byteimg.com/tos-cn-i-13w3uml6bg/512a936fbfc547c9a0fafa993e6cba13~tplv-13w3uml6bg-resize:128:128.image?rk3s=2e2596fd&x-expires=1747331738&x-signature=j4Wk20xjKgtGOYGeqtW9tj%2BJDC0%3D","subtitle":"视频合成_剪映小助手:add_captions","title":"add_captions_3"},"outputs":[{"name":"track_id","required":false,"type":"string"},{"name":"draft_url","required":false,"type":"string"},{"name":"segment_ids","required":false,"schema":{"type":"string"},"type":"list"},{"name":"segment_infos","required":false,"schema":{"schema":[{"name":"end","required":false,"type":"integer"},{"name":"id","required":false,"type":"string"},{"name":"start","required":false,"type":"integer"}],"type":"object"},"type":"list"},{"name":"text_ids","required":false,"schema":{"type":"string"},"type":"list"}]},"edges":null,"id":"150753","meta":{"position":{"x":5286.493101860516,"y":1081.2865408505925}},"type":"4","_temp":{"bounds":{"x":0,"y":0,"width":0,"height":0}}},{"blocks":[],"data":{"inputs":{"fcParamVar":{"knowledgeFCParam":{}},"inputParameters":[{"input":{"type":"string","value":{"content":{"blockID":"100001","name":"title","source":"block-output"},"rawMeta":{"type":1},"type":"ref"}},"name":"input"}],"llmParam":[{"input":{"type":"float","value":{"content":"0.8","rawMeta":{"type":4},"type":"literal"}},"name":"temperature"},{"input":{"type":"integer","value":{"content":"4096","rawMeta":{"type":2},"type":"literal"}},"name":"maxTokens"},{"input":{"type":"integer","value":{"content":"2","rawMeta":{"type":2},"type":"literal"}},"name":"responseFormat"},{"input":{"type":"string","value":{"content":"豆包·1.5·Pro·32k","rawMeta":{"type":1},"type":"literal"}},"name":"modleName"},{"input":{"type":"integer","value":{"content":"1737521813","rawMeta":{"type":2},"type":"literal"}},"name":"modelType"},{"input":{"type":"string","value":{"content":"balance","rawMeta":{"type":1},"type":"literal"}},"name":"generationDiversity"},{"input":{"type":"string","value":{"content":"","rawMeta":{"type":1},"type":"literal"}},"name":"prompt"},{"input":{"type":"boolean","value":{"content":false,"rawMeta":{"type":3},"type":"literal"}},"name":"enableChatHistory"},{"input":{"type":"integer","value":{"content":"3","rawMeta":{"type":2},"type":"literal"}},"name":"chatHistoryRound"},{"input":{"type":"string","value":{"content":"帮我生成一段关于书籍《{{input}}》的一幅插图画面描述，符合书籍内容风格，具有艺术风格。\n画面中避免出现亮色、红色。\n\n输出画面描述提示词，符合Midjourney风格。","rawMeta":{"type":1},"type":"literal"}},"name":"systemPrompt"},{"input":{"type":"string","value":{"content":"","rawMeta":{"type":1},"type":"literal"}},"name":"stableSystemPrompt"},{"input":{"type":"boolean","value":{"content":false,"rawMeta":{"type":3},"type":"literal"}},"name":"canContinue"}],"settingOnError":{"processType":1,"retryTimes":0,"switch":false,"timeoutMs":600000}},"nodeMeta":{"description":"调用大语言模型,使用变量和提示词生成回复","icon":"https://lf3-static.bytednsdoc.com/obj/eden-cn/dvsmryvd_avi_dvsm/ljhwZthlaukjlkulzlp/icon/icon-LLM-v2.jpg","subTitle":"大模型","title":"大模型_2"},"outputs":[{"name":"prompt","required":false,"type":"string"}],"version":"3"},"edges":null,"id":"120003","meta":{"position":{"x":-3653.5068981394847,"y":1233.6365408505924}},"type":"3","_temp":{"bounds":{"x":0,"y":0,"width":0,"height":0}}},{"blocks":[],"data":{"inputs":{"concatParams":[{"input":{"type":"string","value":{"content":"《{{String1}}》| {{String2}}","rawMeta":{"type":1},"type":"literal"}},"name":"concatResult"},{"input":{"type":"string","value":{"content":"，","rawMeta":{"type":1},"type":"literal"}},"name":"arrayItemConcatChar"},{"input":{"schema":{"schema":[{"name":"label","required":true,"type":"string"},{"name":"value","required":true,"type":"string"},{"name":"isDefault","required":true,"type":"boolean"}],"type":"object"},"type":"list","value":{"content":[{"isDefault":true,"label":"换行","value":"\n"},{"isDefault":true,"label":"制表符","value":"\t"},{"isDefault":true,"label":"句号","value":"。"},{"isDefault":true,"label":"逗号","value":"，"},{"isDefault":true,"label":"分号","value":"；"},{"isDefault":true,"label":"空格","value":" "}],"type":"literal"}},"name":"allArrayItemConcatChars"}],"inputParameters":[{"input":{"type":"string","value":{"content":{"blockID":"100001","name":"title","source":"block-output"},"rawMeta":{"type":1},"type":"ref"}},"name":"String1"},{"input":{"type":"string","value":{"content":{"blockID":"168273","name":"Group2","source":"block-output"},"rawMeta":{"type":1},"type":"ref"}},"name":"String2"}],"method":"concat"},"nodeMeta":{"description":"用于处理多个字符串类型变量的格式","icon":"https://lf3-static.bytednsdoc.com/obj/eden-cn/dvsmryvd_avi_dvsm/ljhwZthlaukjlkulzlp/icon/icon-StrConcat-v2.jpg","mainColor":"#3071F2","subTitle":"文本处理","title":"文本处理_TopTitle"},"outputs":[{"name":"output","required":true,"type":"string"}]},"edges":null,"id":"137843","meta":{"position":{"x":-3193.5068981394847,"y":986.4365408505923}},"type":"15","_temp":{"bounds":{"x":0,"y":0,"width":0,"height":0}}},{"blocks":[],"data":{"inputs":{"apiParam":[{"input":{"type":"string","value":{"content":"7457837925833850920","type":"literal"}},"name":"apiID"},{"input":{"type":"string","value":{"content":"add_captions","type":"literal"}},"name":"apiName"},{"input":{"type":"string","value":{"content":"7457837925833801768","type":"literal"}},"name":"pluginID"},{"input":{"type":"string","value":{"content":"剪映草稿","type":"literal"}},"name":"pluginName"},{"input":{"type":"string","value":{"content":"","type":"literal"}},"name":"pluginVersion"},{"input":{"type":"string","value":{"content":"","type":"literal"}},"name":"tips"},{"input":{"type":"string","value":{"content":"","type":"literal"}},"name":"outDocLink"},{"input":{"type":"integer","value":{"content":1742402176,"type":"literal"}},"name":"updateTime"}],"inputDefs":[{"description":"边框颜色，eg：#fe8a80","input":{},"name":"border_color","required":false,"type":"string"},{"description":"草稿地址，使用create_draft输出的draft_url即可","input":{},"name":"draft_url","required":true,"type":"string"},{"description":"行间距，默认0","input":{},"name":"line_spacing","required":false,"type":"float"},{"description":"scale_y缩放","input":{},"name":"scale_y","required":false,"type":"float"},{"description":"0 默认。1富文本样式","input":{},"name":"style_text","required":false,"type":"integer"},{"description":"transform_y位置","input":{},"name":"transform_y","required":false,"type":"float"},{"description":"字幕的对齐方式，0左对齐，1 居中对齐，2右对齐","input":{},"name":"alignment","required":false,"type":"integer"},{"description":"查看说明：https://krxc4izye0.feishu.cn/wiki/HhQrw3BFhi1XGOkkJCBcfkqGnwf?from=from_copylink","input":{},"name":"captions","required":true,"type":"string"},{"description":"字体列表：https://krxc4izye0.feishu.cn/wiki/SmnrwabXriG7JckEzyGcChk4nDd","input":{},"name":"font","required":false,"type":"string"},{"description":"默认：15","input":{},"name":"font_size","required":false,"type":"integer"},{"description":"字间距，默认0","input":{},"name":"letter_spacing","required":false,"type":"float"},{"description":"scale_x缩放","input":{},"name":"scale_x","required":false,"type":"float"},{"description":"文字颜色：#ff1837","input":{},"name":"text_color","required":false,"type":"string"},{"description":"transform_x位置","input":{},"name":"transform_x","required":false,"type":"float"}],"inputParameters":[{"input":{"type":"string","value":{"content":{"blockID":"175205","name":"topcaptions","source":"block-output"},"rawMeta":{"type":1},"type":"ref"}},"name":"captions"},{"input":{"type":"string","value":{"content":{"blockID":"119835","name":"draft_url","source":"block-output"},"rawMeta":{"type":1},"type":"ref"}},"name":"draft_url"},{"input":{"type":"integer","value":{"content":2,"rawMeta":{"type":2},"type":"literal"}},"name":"alignment"},{"input":{"type":"string","value":{"content":"#000000","rawMeta":{"type":1},"type":"literal"}},"name":"border_color"},{"input":{"type":"string","value":{"content":"金陵体","rawMeta":{"type":1},"type":"literal"}},"name":"font"},{"input":{"type":"integer","value":{"content":5,"rawMeta":{"type":2},"type":"literal"}},"name":"font_size"},{"input":{"type":"string","value":{"content":"#ffffff","rawMeta":{"type":1},"type":"literal"}},"name":"text_color"},{"input":{"type":"float","value":{"content":735,"rawMeta":{"type":4},"type":"literal"}},"name":"transform_x"},{"input":{"type":"float","value":{"content":958,"rawMeta":{"type":4},"type":"literal"}},"name":"transform_y"}],"settingOnError":{"processType":1,"retryTimes":0,"timeoutMs":180000}},"nodeMeta":{"description":"批量添加字幕","icon":"https://lf3-static.bytednsdoc.com/obj/eden-cn/dvsmryvd_avi_dvsm/ljhwZthlaukjlkulzlp/icon/icon-Plugin-v2.jpg","subtitle":"剪映草稿:add_captions","title":"add_captions_top"},"outputs":[{"name":"draft_url","required":false,"type":"string"},{"name":"segment_ids","required":false,"schema":{"type":"string"},"type":"list"},{"name":"segment_infos","required":false,"schema":{"schema":[{"name":"end","required":false,"type":"integer"},{"name":"id","required":false,"type":"string"},{"name":"start","required":false,"type":"integer"}],"type":"object"},"type":"list"},{"name":"text_ids","required":false,"schema":{"type":"string"},"type":"list"},{"name":"track_id","required":false,"type":"string"}]},"edges":null,"id":"126860","meta":{"position":{"x":6206.493101860516,"y":873.5865408505922}},"type":"4","_temp":{"bounds":{"x":0,"y":0,"width":0,"height":0}}}],"versions":{"loop":"v2"}},"bounds":{"x":0,"y":0,"width":4567,"height":1234}}