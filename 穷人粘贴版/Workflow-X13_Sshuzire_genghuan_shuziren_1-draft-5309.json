{"type":"coze-workflow-clipboard-data","source":{"workflowId":"7531333812451147811","spaceId":"","host":"www.coze.cn","isDouyin":false,"flowMode":0},"json":{"edges":[{"sourceNodeID":"100001","sourcePortID":"","targetNodeID":"165064"},{"sourceNodeID":"168820","sourcePortID":"","targetNodeID":"900001"},{"sourceNodeID":"165064","sourcePortID":"","targetNodeID":"124534"},{"sourceNodeID":"124534","sourcePortID":"loop-output","targetNodeID":"168820"}],"nodes":[{"blocks":[],"data":{"nodeMeta":{"description":"工作流的起始节点，用于设定启动工作流需要的信息","icon":"https://lf3-static.bytednsdoc.com/obj/eden-cn/dvsmryvd_avi_dvsm/ljhwZthlaukjlkulzlp/icon/icon-Start-v2.jpg","subTitle":"","title":"开始"},"outputs":[{"name":"text","required":true,"type":"string"},{"name":"video_url","required":false,"type":"string"},{"name":"hifly_id","required":false,"type":"string"},{"name":"speaker_id","required":false,"type":"string"}],"trigger_parameters":[{"name":"text","required":true,"type":"string"},{"name":"video_url","required":false,"type":"string"},{"name":"hifly_id","required":false,"type":"string"},{"name":"speaker_id","required":false,"type":"string"}]},"edges":null,"id":"100001","meta":{"position":{"x":-1153.7583911432846,"y":113.05258620689659}},"type":"1"},{"blocks":[],"data":{"inputs":{"inputParameters":[{"input":{"type":"string","value":{"content":{"blockID":"168820","name":"output","source":"block-output"},"rawMeta":{"type":1},"type":"ref"}},"name":"output"}],"terminatePlan":"returnVariables"},"nodeMeta":{"description":"工作流的最终节点，用于返回工作流运行后的结果信息","icon":"https://lf3-static.bytednsdoc.com/obj/eden-cn/dvsmryvd_avi_dvsm/ljhwZthlaukjlkulzlp/icon/icon-End-v2.jpg","subTitle":"","title":"结束"}},"edges":null,"id":"900001","meta":{"position":{"x":2276.8150151975233,"y":100.05258620689659}},"type":"2"},{"blocks":[{"blocks":[],"data":{"inputs":{"branches":[{"condition":{"conditions":[{"left":{"input":{"type":"string","value":{"content":{"blockID":"180067","name":"video_Url","source":"block-output"},"type":"ref"}}},"operator":10}],"logic":2}}]},"nodeMeta":{"description":"连接多个下游分支，若设定的条件成立则仅运行对应的分支，若均不成立则只运行“否则”分支","icon":"https://lf3-static.bytednsdoc.com/obj/eden-cn/dvsmryvd_avi_dvsm/ljhwZthlaukjlkulzlp/icon/icon-Condition-v2.jpg","mainColor":"#00B2B2","subTitle":"选择器","title":"选择器_1"}},"edges":null,"id":"137563","meta":{"position":{"x":640,"y":59.449999999999974}},"type":"8"},{"blocks":[],"data":{"nodeMeta":{"description":"用于终止当前循环，执行下次循环","icon":"https://lf3-static.bytednsdoc.com/obj/eden-cn/dvsmryvd_avi_dvsm/ljhwZthlaukjlkulzlp/icon/icon-Continue-v2.jpg","mainColor":"#00B2B2","subTitle":"继续循环","title":"继续循环"}},"edges":null,"id":"171006","meta":{"position":{"x":1560,"y":190.89999999999998}},"type":"29"},{"blocks":[],"data":{"inputs":{"code":"/**\n * @author 作者微信: shuidi_tech\n */\n// 在这里，您可以通过 ‘params’  获取节点中的输入变量，并通过 'ret' 输出结果\n// 'params' 和 'ret' 已经被正确地注入到环境中\n// 下面是一个示例，获取节点输入中参数名为‘input’的值：\n// const input = params.input; \n// 下面是一个示例，输出一个包含多种数据类型的 'ret' 对象：\n// const ret = { \"name\": ‘小明’, \"hobbies\": [“看书”, “旅游”] };\n\nasync function main({ params }: Args): Promise<Output> {\n    await new Promise<void>(resolve => setTimeout(resolve, 1000 * 3));\n\n    return {\n        output: 0\n    };\n}","inputParameters":[],"language":5,"settingOnError":{"processType":1,"retryTimes":0,"switch":false,"timeoutMs":60000}},"nodeMeta":{"description":"编写代码，处理输入变量来生成返回值","icon":"https://lf3-static.bytednsdoc.com/obj/eden-cn/dvsmryvd_avi_dvsm/ljhwZthlaukjlkulzlp/icon/icon-Code-v2.jpg","subTitle":"代码","title":"代码"},"outputs":[{"name":"output","required":false,"type":"float"}]},"edges":null,"id":"191861","meta":{"position":{"x":1100,"y":167.89999999999998}},"type":"5"},{"blocks":[],"data":{"nodeMeta":{"description":"用于立即终止当前所在的循环，跳出循环体","icon":"https://lf3-static.bytednsdoc.com/obj/eden-cn/dvsmryvd_avi_dvsm/ljhwZthlaukjlkulzlp/icon/icon-Break-v2.jpg","mainColor":"#00B2B2","subTitle":"终止循环","title":"终止循环"}},"edges":null,"id":"145340","meta":{"position":{"x":1100,"y":-1.4210854715202004e-14}},"type":"19"},{"blocks":[],"data":{"inputs":{"apiParam":[{"input":{"type":"string","value":{"content":"7472321822705369126","rawMeta":{"type":1},"type":"literal"}},"name":"apiID"},{"input":{"type":"string","value":{"content":"inspect_video_creation_status","rawMeta":{"type":1},"type":"literal"}},"name":"apiName"},{"input":{"type":"string","value":{"content":"7472321822705336358","rawMeta":{"type":1},"type":"literal"}},"name":"pluginID"},{"input":{"type":"string","value":{"content":"飞影数字人","rawMeta":{"type":1},"type":"literal"}},"name":"pluginName"},{"input":{"type":"string","value":{"content":"","rawMeta":{"type":1},"type":"literal"}},"name":"pluginVersion"},{"input":{"type":"string","value":{"content":"","rawMeta":{"type":1},"type":"literal"}},"name":"tips"},{"input":{"type":"string","value":{"content":"","rawMeta":{"type":1},"type":"literal"}},"name":"outDocLink"}],"inputDefs":[{"description":"飞影会员可在个人中心（https://hifly.cc/setting?code=3N7qFanVMQ6）查看 hifly_agent_token。非必填，不填走免费使用模式（作品有水印和时长限制）","input":{},"name":"hifly_id","required":false,"type":"string"},{"description":"作品ID","input":{},"name":"job_id","required":true,"type":"integer"}],"inputParameters":[{"input":{"type":"integer","value":{"content":{"blockID":"165064","name":"job_id","source":"block-output"},"rawMeta":{"type":2},"type":"ref"}},"name":"job_id"},{"input":{"type":"string","value":{"content":{"blockID":"100001","name":"hifly_id","source":"block-output"},"rawMeta":{"type":1},"type":"ref"}},"name":"hifly_id"}],"settingOnError":{"processType":1,"retryTimes":0,"timeoutMs":180000}},"nodeMeta":{"description":"查询数字人对口型视频作品的状态","icon":"https://lf3-static.bytednsdoc.com/obj/eden-cn/dvsmryvd_avi_dvsm/ljhwZthlaukjlkulzlp/icon/icon-Plugin-v2.jpg","subtitle":"飞影数字人:inspect_video_creation_status","title":"inspect_video_creation_status"},"outputs":[{"description":"失败时错误码","name":"code","required":false,"type":"integer"},{"description":"作品时长，单位:秒","name":"duration","required":false,"type":"integer"},{"description":"失败时返回错误信息","name":"message","required":false,"type":"string"},{"description":"请求码","name":"request_id","required":false,"type":"string"},{"description":"作品状态， 1:等待中 2:处理中 3:完成 4:失败","name":"status","required":false,"type":"integer"},{"description":"合成的视频地址。这是一个临时地址，请尽快转存。url 中会带有 query 参数，下载视频时请确保已兼容。","name":"video_Url","required":false,"type":"string"}]},"edges":null,"id":"180067","meta":{"position":{"x":180,"y":72.44999999999997}},"type":"4"}],"data":{"inputs":{"inputParameters":[],"loopCount":{"type":"integer","value":{"content":"10","type":"literal"}},"loopType":"infinite","variableParameters":[{"input":{"type":"integer","value":{"content":{"blockID":"165064","name":"job_id","source":"block-output"},"rawMeta":{"type":2},"type":"ref"}},"name":"variable"}]},"nodeMeta":{"description":"用于通过设定循环次数和逻辑，重复执行一系列任务","icon":"https://lf3-static.bytednsdoc.com/obj/eden-cn/dvsmryvd_avi_dvsm/ljhwZthlaukjlkulzlp/icon/icon-Loop-v2.jpg","mainColor":"#00B2B2","subTitle":"循环","title":"循环"},"outputs":[{"input":{"schema":{"type":"string"},"type":"list","value":{"content":{"blockID":"180067","name":"video_Url","source":"block-output"},"rawMeta":{"type":1},"type":"ref"}},"name":"output"}]},"edges":[{"sourceNodeID":"180067","sourcePortID":"","targetNodeID":"137563"},{"sourceNodeID":"137563","sourcePortID":"false","targetNodeID":"191861"},{"sourceNodeID":"137563","sourcePortID":"true","targetNodeID":"145340"},{"sourceNodeID":"191861","sourcePortID":"","targetNodeID":"171006"},{"sourceNodeID":"124534","sourcePortID":"loop-function-inline-output","targetNodeID":"180067"}],"id":"124534","meta":{"canvasPosition":{"x":-281.83512962471553,"y":693.7163319720249},"position":{"x":573.1766830870281,"y":100.05258620689659}},"type":"21"},{"blocks":[],"data":{"inputs":{"code":"// 在这里，您可以通过 ‘params’  获取节点中的输入变量，并通过 'ret' 输出结果\n// 'params' 和 'ret' 已经被正确地注入到环境中\n// 下面是一个示例，获取节点输入中参数名为‘input’的值：\n// const input = params.input; \n// 下面是一个示例，输出一个包含多种数据类型的 'ret' 对象：\n// const ret = { \"name\": ‘小明’, \"hobbies\": [“看书”, “旅游”] };\n\nfunction filterFirstNonEmpty(data) {\n    // 确保输入是数组\n    if (!Array.isArray(data)) {\n        throw new Error(\"Input data.output must be an array.\");\n    }\n\n    // 找到第一个非空的元素\n    const firstNonEmpty = data.find(item => item.trim() !== \"\");\n\n    // 如果找到非空元素，返回该元素；否则返回空字符串\n    return firstNonEmpty || \"\";\n}\n\nasync function main({ params }: Args): Promise<Output> {\n    return {\n        output: filterFirstNonEmpty(params.input)\n    };\n}\n","inputParameters":[{"input":{"schema":{"type":"string"},"type":"list","value":{"content":{"blockID":"124534","name":"output","source":"block-output"},"rawMeta":{"type":99},"type":"ref"}},"name":"input"}],"language":5,"settingOnError":{"processType":1,"retryTimes":0,"switch":false,"timeoutMs":60000}},"nodeMeta":{"description":"编写代码，处理输入变量来生成返回值","icon":"https://lf3-static.bytednsdoc.com/obj/eden-cn/dvsmryvd_avi_dvsm/ljhwZthlaukjlkulzlp/icon/icon-Code-v2.jpg","subTitle":"代码","title":"代码_1"},"outputs":[{"name":"output","required":false,"type":"string"}]},"edges":null,"id":"168820","meta":{"position":{"x":1823.176683087028,"y":100.05258620689659}},"type":"5"},{"blocks":[],"data":{"inputs":{"apiParam":[{"input":{"type":"string","value":{"content":"7472321822705352742","rawMeta":{"type":1},"type":"literal"}},"name":"apiID"},{"input":{"type":"string","value":{"content":"create_lipsync_video","rawMeta":{"type":1},"type":"literal"}},"name":"apiName"},{"input":{"type":"string","value":{"content":"7472321822705336358","rawMeta":{"type":1},"type":"literal"}},"name":"pluginID"},{"input":{"type":"string","value":{"content":"飞影数字人","rawMeta":{"type":1},"type":"literal"}},"name":"pluginName"},{"input":{"type":"string","value":{"content":"","rawMeta":{"type":1},"type":"literal"}},"name":"pluginVersion"},{"input":{"type":"string","value":{"content":"","rawMeta":{"type":1},"type":"literal"}},"name":"tips"},{"input":{"type":"string","value":{"content":"","rawMeta":{"type":1},"type":"literal"}},"name":"outDocLink"}],"inputDefs":[{"assistType":1,"description":"音频文件地址，音频驱动时必填，支持 mp3、m4a、wav 等格式，20M 以内，时长范围 5 秒 ～ 30 分钟","input":{},"name":"audio_url","required":false,"type":"string"},{"description":"作品名称，默认\"未命名\"，不超过 20 个字。","input":{},"name":"title","required":false,"type":"string"},{"assistType":1,"description":"视频文件地址，视频驱动必填，支持 mp4、mov 格式且使用 h264 编码，20MB 以内，分辨率范围 360p ～ 4K，时长范围 5 秒～ 30 分钟。注意：相同 URL 视为同一个数字人。 字符长度不超过 500","input":{},"name":"video_url","required":false,"type":"string"},{"description":"已弃用","input":{},"name":"voice_id","required":false,"type":"integer"},{"description":"已弃用","input":{},"name":"voice_type","required":false,"type":"integer"},{"description":"飞影会员可在个人中心（https://hifly.cc/setting?code=3N7qFanVMQ6）查看 hifly_agent_token。非必填，不填走免费使用模式（作品有水印和时长限制）","input":{},"name":"hifly_id","required":false,"type":"string"},{"description":"声音 ID，文本驱动时必填，speaker_id 在 https://hifly.cc 中可查询，声音市场有大量声音可免费使用","input":{},"name":"speaker_id","required":false,"type":"string"},{"description":"文本内容，文本驱动/输出仅音频时必填，不超过 10000 字，不支持 html 标签","input":{},"name":"text","required":false,"type":"string"}],"inputParameters":[{"input":{"type":"string","value":{"content":{"blockID":"100001","name":"hifly_id","source":"block-output"},"rawMeta":{"type":1},"type":"ref"}},"name":"hifly_id"},{"input":{"type":"string","value":{"content":{"blockID":"100001","name":"speaker_id","source":"block-output"},"rawMeta":{"type":1},"type":"ref"}},"name":"speaker_id"},{"input":{"type":"string","value":{"content":{"blockID":"100001","name":"text","source":"block-output"},"rawMeta":{"type":1},"type":"ref"}},"name":"text"},{"input":{"assistType":10,"type":"string","value":{"content":{"blockID":"100001","name":"video_url","source":"block-output"},"rawMeta":{"type":16},"type":"ref"}},"name":"video_url"}],"settingOnError":{"processType":1,"retryTimes":0,"timeoutMs":180000}},"nodeMeta":{"description":"输入人物视频，以及一段音频或文本，生成对口型数字人视频。飞影会员（https://hifly.cc 免费注册）可生成无时长限制、无水印的视频。\n用文本驱动时需指定声音ID，可选择以下声音：\n芳芳（适合童声、故事、宣传片）：0bdcbf49-5704-4a18-b4c5-1fcee7b6b1e2\n小李（适合口播、培训）：570f41c9-0fdd-415e-939b-1e9335851494\n老中医（适合健康科普）：96728d36-dfbe-4285-ad4d-879c46a013d2\n李阿姨（适合电商带货）：2654756a-c7d9-4b81-97d3-e9e76d56d7ff\n红女郎（适合口播、培训）：1169ef2d-7911-4b0c-855e-188e8a76ca53\n\n更多声音可前往 https://hifly.cc/market/voice 选择（收藏声音后，可在\"我的收藏”中复制声音ID），也可一键复刻（https://hifly.cc/clone）声音，支持7种语言5种方言","icon":"https://lf3-static.bytednsdoc.com/obj/eden-cn/dvsmryvd_avi_dvsm/ljhwZthlaukjlkulzlp/icon/icon-Plugin-v2.jpg","subtitle":"飞影数字人:create_lipsync_video","title":"create_lipsync_video"},"outputs":[{"description":"请求码","name":"request_id","required":false,"type":"string"},{"description":"失败时错误码","name":"code","required":false,"type":"integer"},{"description":"作品 id","name":"job_id","required":false,"type":"integer"},{"description":"失败时返回错误信息","name":"message","required":false,"type":"string"}]},"edges":null,"id":"165064","meta":{"position":{"x":-676.8233169129719,"y":100.05258620689659}},"type":"4"},{"blocks":[],"data":{"inputs":{"note":"[{\"type\":\"heading-three\",\"children\":[{\"text\":\"参数说明\",\"type\":\"text\"}]},{\"type\":\"bulleted-list\",\"children\":[{\"type\":\"list-item\",\"children\":[{\"text\":\"text: 口播内容\",\"type\":\"text\"}]},{\"type\":\"list-item\",\"children\":[{\"text\":\"[可选参数] video_url: 数字人视频模板\",\"type\":\"text\"}]}]},{\"type\":\"bulleted-list\",\"children\":[{\"type\":\"list-item\",\"children\":[{\"text\":\"[可选参数] hifly_id: 飞影会员可在\",\"type\":\"text\"},{\"text\":\"个人中心\",\"link\":\"https://hifly.cc/setting?code=3N7qFanVMQ6\",\"type\":\"text\"},{\"text\":\"查看 hifly_agent_token。非必填，不填走免费使用模式（作品有水印和时长限制）（飞影数字人邀请码: LnSVFsaRAZq）\",\"type\":\"text\"}]}]},{\"type\":\"bulleted-list\",\"children\":[{\"type\":\"list-item\",\"children\":[{\"text\":\"[可选参数] speaker_id: 声音 ID，文本驱动时必填，speaker_id 在 https://hifly.cc 中可查询，声音市场有大量声音可免费使用\",\"type\":\"text\"}]}]}]","schemaType":"slate"},"size":{"height":206.58532670848552,"width":357.59138206607145}},"edges":null,"id":"191800","meta":{"position":{"x":-1136.823316912972,"y":295.0025862068966}},"type":"31"}],"versions":{"loop":"v2"}}}