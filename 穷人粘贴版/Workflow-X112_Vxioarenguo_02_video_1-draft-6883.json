{"type":"coze-workflow-clipboard-data","source":{"workflowId":"7531641237468938291","spaceId":"","host":"www.coze.cn","isDouyin":false,"flowMode":0},"json":{"edges":[{"sourceNodeID":"100001","sourcePortID":"","targetNodeID":"122647"},{"sourceNodeID":"160931","sourcePortID":"","targetNodeID":"900001"},{"sourceNodeID":"138533","sourcePortID":"","targetNodeID":"168020"},{"sourceNodeID":"168020","sourcePortID":"","targetNodeID":"160931"},{"sourceNodeID":"122647","sourcePortID":"","targetNodeID":"138533"}],"nodes":[{"blocks":[],"data":{"nodeMeta":{"description":"工作流的起始节点，用于设定启动工作流需要的信息","icon":"https://lf3-static.bytednsdoc.com/obj/eden-cn/dvsmryvd_avi_dvsm/ljhwZthlaukjlkulzlp/icon/icon-Start-v2.jpg","subTitle":"","title":"开始"},"outputs":[{"description":"把上一步输出的table_id输入到此处，检查视频生成状态","name":"input","required":false,"type":"string"}],"trigger_parameters":[{"description":"把上一步输出的table_id输入到此处，检查视频生成状态","name":"input","required":false,"type":"string"}]},"edges":null,"id":"100001","meta":{"position":{"x":-873.7315189081189,"y":-314.73251199726576}},"type":"1"},{"blocks":[],"data":{"inputs":{"inputParameters":[{"input":{"type":"string","value":{"content":{"blockID":"100001","name":"input","source":"block-output"},"rawMeta":{"type":1},"type":"ref"}},"name":"table_id"},{"input":{"type":"string","value":{"content":{"blockID":"160931","name":"web_url","source":"block-output"},"rawMeta":{"type":1},"type":"ref"}},"name":"web_url"},{"input":{"type":"boolean","value":{"content":{"blockID":"168020","name":"done","source":"block-output"},"rawMeta":{"type":3},"type":"ref"}},"name":"done"}],"terminatePlan":"returnVariables"},"nodeMeta":{"description":"工作流的最终节点，用于返回工作流运行后的结果信息","icon":"https://lf3-static.bytednsdoc.com/obj/eden-cn/dvsmryvd_avi_dvsm/ljhwZthlaukjlkulzlp/icon/icon-End-v2.jpg","subTitle":"","title":"结束"}},"edges":null,"id":"900001","meta":{"position":{"x":1797.209255668324,"y":-183.19131296221548}},"type":"2"},{"blocks":[],"data":{"inputs":{"code":"async function main({ params }: Args): Promise<Output> {\n    let done = true;\n    // 明确指定 video_urls 的类型为 string[]\n    const video_urls: string[] = [];\n\n    for (const item of params.data) {\n        // 安全访问嵌套属性\n        const videoUrl = item?.result?.video_url;\n        \n        if (typeof videoUrl === 'string' && videoUrl.trim() !== '') {\n            video_urls.push(videoUrl);\n        } else {\n            video_urls.push('');\n            done = false;\n        }\n    }\n\n    return {\n        \"done\": done,\n        \n        video_urls\n    };\n}","inputParameters":[{"input":{"schema":{"schema":[{"name":"code","required":false,"type":"integer"},{"name":"msg","required":false,"type":"string"},{"name":"result","required":false,"schema":[{"name":"completion_tokens","required":false,"type":"integer"},{"name":"hs_token","required":false,"type":"string"},{"name":"image_url","required":false,"type":"string"},{"name":"user_id","required":false,"type":"integer"},{"name":"video_url","required":false,"type":"string"},{"name":"status","required":false,"type":"string"},{"name":"task_id","required":false,"type":"string"},{"name":"updated_at","required":false,"type":"string"},{"name":"created_at","required":false,"type":"string"},{"name":"duration","required":false,"type":"integer"},{"name":"id","required":false,"type":"string"},{"name":"prompt","required":false,"type":"string"},{"name":"prompt_tokens","required":false,"type":"integer"}],"type":"object"},{"name":"tip_url","required":false,"type":"string"}],"type":"object"},"type":"list","value":{"content":{"blockID":"138533","name":"outputList","source":"block-output"},"rawMeta":{"type":103},"type":"ref"}},"name":"data"}],"language":5,"settingOnError":{"processType":1,"retryTimes":0,"switch":false,"timeoutMs":60000}},"nodeMeta":{"description":"编写代码，处理输入变量来生成返回值","icon":"https://lf3-static.bytednsdoc.com/obj/eden-cn/dvsmryvd_avi_dvsm/ljhwZthlaukjlkulzlp/icon/icon-Code-v2.jpg","subTitle":"代码","title":"代码"},"outputs":[{"name":"done","required":false,"type":"boolean"},{"name":"video_urls","required":false,"schema":{"type":"string"},"type":"list"}]},"edges":null,"id":"168020","meta":{"position":{"x":751.6528345974134,"y":-236.19131296221545}},"type":"5"},{"blocks":[],"data":{"inputs":{"apiParam":[{"input":{"type":"string","value":{"content":"7494245680807084082","rawMeta":{"type":1},"type":"literal"}},"name":"apiID"},{"input":{"type":"string","value":{"content":"get_table","rawMeta":{"type":1},"type":"literal"}},"name":"apiName"},{"input":{"type":"string","value":{"content":"7494245680807051314","rawMeta":{"type":1},"type":"literal"}},"name":"pluginID"},{"input":{"type":"string","value":{"content":"超级多维表格","rawMeta":{"type":1},"type":"literal"}},"name":"pluginName"},{"input":{"type":"string","value":{"content":"","rawMeta":{"type":1},"type":"literal"}},"name":"pluginVersion"},{"input":{"type":"string","value":{"content":"","rawMeta":{"type":1},"type":"literal"}},"name":"tips"},{"input":{"type":"string","value":{"content":"","rawMeta":{"type":1},"type":"literal"}},"name":"outDocLink"}],"inputParameters":[{"input":{"type":"string","value":{"content":{"blockID":"100001","name":"input","source":"block-output"},"rawMeta":{"type":1},"type":"ref"}},"name":"table_id"},{"input":{"type":"string","value":{"content":"任务ID","rawMeta":{"type":1},"type":"literal"}},"name":"name"}],"settingOnError":{"processType":1,"retryTimes":0,"timeoutMs":180000}},"nodeMeta":{"description":"云数据库记录，可以快速记录批量数据，支持预览和修改。","icon":"https://p26-flow-product-sign.byteimg.com/tos-cn-i-13w3uml6bg/58988df7861f40bca7fcc630a927a451~tplv-13w3uml6bg-resize:128:128.image?rk3s=2e2596fd&x-expires=1750728857&x-signature=NLdOA6BH1qouGK6yzMo5Y659udQ%3D","subtitle":"超级多维表格:get_table","title":"get_table"},"outputs":[{"name":"data","required":false,"schema":[{"name":"web_url","required":false,"type":"string"},{"name":"pagination","required":false,"schema":[{"name":"page_size","required":false,"type":"integer"},{"name":"total_pages","required":false,"type":"integer"},{"name":"total_rows","required":false,"type":"integer"},{"name":"page","required":false,"type":"integer"}],"type":"object"},{"name":"result","required":false,"schema":{"schema":[{"name":"datas","required":false,"schema":{"type":"string"},"type":"list"},{"name":"title","required":false,"type":"string"}],"type":"object"},"type":"list"},{"name":"table_name","required":false,"type":"string"}],"type":"object"},{"name":"success","required":false,"type":"boolean"}]},"edges":null,"id":"122647","meta":{"position":{"x":-384.43976599444215,"y":-339.73251199726576}},"type":"4"},{"blocks":[],"data":{"inputs":{"apiParam":[{"input":{"type":"string","value":{"content":"7494245680807100466","rawMeta":{"type":1},"type":"literal"}},"name":"apiID"},{"input":{"type":"string","value":{"content":"save_list","rawMeta":{"type":1},"type":"literal"}},"name":"apiName"},{"input":{"type":"string","value":{"content":"7494245680807051314","rawMeta":{"type":1},"type":"literal"}},"name":"pluginID"},{"input":{"type":"string","value":{"content":"超级多维表格","rawMeta":{"type":1},"type":"literal"}},"name":"pluginName"},{"input":{"type":"string","value":{"content":"","rawMeta":{"type":1},"type":"literal"}},"name":"pluginVersion"},{"input":{"type":"string","value":{"content":"","rawMeta":{"type":1},"type":"literal"}},"name":"tips"},{"input":{"type":"string","value":{"content":"","rawMeta":{"type":1},"type":"literal"}},"name":"outDocLink"}],"inputParameters":[{"input":{"schema":{"type":"string"},"type":"list","value":{"content":{"blockID":"168020","name":"video_urls","source":"block-output"},"rawMeta":{"type":99},"type":"ref"}},"name":"datas"},{"input":{"type":"string","value":{"content":"视频","rawMeta":{"type":1},"type":"literal"}},"name":"name"},{"input":{"type":"string","value":{"content":{"blockID":"100001","name":"input","source":"block-output"},"rawMeta":{"type":1},"type":"ref"}},"name":"table_id"}],"settingOnError":{"processType":1,"retryTimes":0,"timeoutMs":180000}},"nodeMeta":{"description":"云数据库记录，可以快速记录批量数据，支持预览和修改。","icon":"https://p26-flow-product-sign.byteimg.com/tos-cn-i-13w3uml6bg/58988df7861f40bca7fcc630a927a451~tplv-13w3uml6bg-resize:128:128.image?rk3s=2e2596fd&x-expires=1750728857&x-signature=NLdOA6BH1qouGK6yzMo5Y659udQ%3D","subtitle":"超级多维表格:save_list","title":"save_list"},"outputs":[{"name":"data","required":false,"schema":[{"name":"added_rows","required":false,"schema":{"type":"string"},"type":"list"},{"name":"message","required":false,"type":"string"},{"name":"table_id","required":false,"type":"string"},{"name":"total_rows","required":false,"type":"integer"},{"name":"updated_rows","required":false,"schema":{"type":"integer"},"type":"list"}],"type":"object"},{"name":"message","required":false,"type":"string"},{"name":"success","required":false,"type":"boolean"},{"name":"web_url","required":false,"type":"string"}]},"edges":null,"id":"160931","meta":{"position":{"x":1340.7120512456574,"y":-195.19131296221545}},"type":"4"},{"blocks":[],"data":{"inputs":{"apiParam":[{"input":{"type":"string","value":{"content":"7509780733309894665","rawMeta":{"type":1},"type":"literal"}},"name":"apiID"},{"input":{"type":"string","value":{"content":"task_info_v2","rawMeta":{"type":1},"type":"literal"}},"name":"apiName"},{"input":{"type":"string","value":{"content":"7504579163953774592","rawMeta":{"type":1},"type":"literal"}},"name":"pluginID"},{"input":{"type":"string","value":{"content":"豆包图生视频","rawMeta":{"type":1},"type":"literal"}},"name":"pluginName"},{"input":{"type":"string","value":{"content":"","rawMeta":{"type":1},"type":"literal"}},"name":"pluginVersion"},{"input":{"type":"string","value":{"content":"","rawMeta":{"type":1},"type":"literal"}},"name":"tips"},{"input":{"type":"string","value":{"content":"","rawMeta":{"type":1},"type":"literal"}},"name":"outDocLink"}],"batch":{"batchEnable":true,"batchSize":100,"concurrentSize":10,"inputLists":[{"input":{"schema":{"type":"string"},"type":"list","value":{"content":{"blockID":"122647","name":"data.result.datas","source":"block-output"},"rawMeta":{"type":99},"type":"ref"}},"name":"item1"}]},"inputParameters":[{"input":{"type":"string","value":{"content":{"blockID":"138533","name":"item1","source":"block-output"},"rawMeta":{"type":1},"type":"ref"}},"name":"task_id"}],"settingOnError":{"processType":1,"retryTimes":0,"timeoutMs":180000}},"nodeMeta":{"description":"获取任务信息","icon":"https://p9-flow-product-sign.byteimg.com/tos-cn-i-13w3uml6bg/1609ed4d3e0d45a9afb7c08c9ddd65b0~tplv-13w3uml6bg-resize:128:128.image?rk3s=2e2596fd&x-expires=1751702316&x-signature=3OjMzDQkJcsdmAObR4Fi2379q5s%3D","subtitle":"豆包图生视频:task_info_v2","title":"task_info_v2"},"outputs":[{"name":"outputList","schema":{"schema":[{"name":"code","required":false,"type":"integer"},{"name":"msg","required":false,"type":"string"},{"name":"result","required":false,"schema":[{"name":"completion_tokens","required":false,"type":"integer"},{"name":"hs_token","required":false,"type":"string"},{"name":"image_url","required":false,"type":"string"},{"name":"user_id","required":false,"type":"integer"},{"name":"video_url","required":false,"type":"string"},{"name":"status","required":false,"type":"string"},{"name":"task_id","required":false,"type":"string"},{"name":"updated_at","required":false,"type":"string"},{"name":"created_at","required":false,"type":"string"},{"name":"duration","required":false,"type":"integer"},{"name":"id","required":false,"type":"string"},{"name":"prompt","required":false,"type":"string"},{"name":"prompt_tokens","required":false,"type":"integer"}],"type":"object"},{"name":"tip_url","required":false,"type":"string"}],"type":"object"},"type":"list"}]},"edges":null,"id":"138533","meta":{"position":{"x":168.4135240645195,"y":-315.73251199726576}},"type":"4"}],"versions":{"loop":"v2"}}}