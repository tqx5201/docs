{"type":"coze-workflow-clipboard-data","source":{"workflowId":"7531636777048883239","spaceId":"","host":"www.coze.cn","isDouyin":false,"flowMode":0},"json":{"edges":[{"sourceNodeID":"136025","sourcePortID":"","targetNodeID":"152455"},{"sourceNodeID":"152455","sourcePortID":"","targetNodeID":"154682"},{"sourceNodeID":"163129","sourcePortID":"","targetNodeID":"180681"},{"sourceNodeID":"180681","sourcePortID":"batch-output","targetNodeID":"180456"},{"sourceNodeID":"173538","sourcePortID":"","targetNodeID":"163129"},{"sourceNodeID":"154682","sourcePortID":"","targetNodeID":"173538"},{"sourceNodeID":"133547","sourcePortID":"","targetNodeID":"169595"},{"sourceNodeID":"169595","sourcePortID":"loop-output","targetNodeID":"152586"},{"sourceNodeID":"180947","sourcePortID":"","targetNodeID":"168118"},{"sourceNodeID":"168118","sourcePortID":"","targetNodeID":"125268"},{"sourceNodeID":"125268","sourcePortID":"","targetNodeID":"122915"},{"sourceNodeID":"152586","sourcePortID":"","targetNodeID":"150526"},{"sourceNodeID":"122915","sourcePortID":"","targetNodeID":"159780"},{"sourceNodeID":"159780","sourcePortID":"","targetNodeID":"158201"},{"sourceNodeID":"158201","sourcePortID":"","targetNodeID":"104782"},{"sourceNodeID":"150526","sourcePortID":"","targetNodeID":"180223"},{"sourceNodeID":"180223","sourcePortID":"","targetNodeID":"195949"},{"sourceNodeID":"195949","sourcePortID":"","targetNodeID":"180947"},{"sourceNodeID":"180456","sourcePortID":"","targetNodeID":"133547"}],"nodes":[{"blocks":[],"data":{"inputs":{"inputParameters":[{"input":{"type":"string","value":{"content":{"blockID":"100001","name":"title","source":"block-output"},"dependencies":{"variables":null},"inputMode":"","rawMeta":{"type":1},"type":"ref"}},"left":{},"name":"title","right":{}}],"llmParam":[{"input":{"type":"string","value":{"content":"balance","dependencies":{"variables":null},"inputMode":"","rawMeta":{"type":1},"type":"literal"}},"left":{},"name":"generationDiversity","right":{}},{"input":{"type":"float","value":{"content":"0.8","dependencies":{"variables":null},"inputMode":"","rawMeta":{"type":4},"type":"literal"}},"left":{},"name":"temperature","right":{}},{"input":{"type":"integer","value":{"content":"4096","dependencies":{"variables":null},"inputMode":"","rawMeta":{"type":2},"type":"literal"}},"left":{},"name":"maxTokens","right":{}},{"input":{"type":"integer","value":{"content":"2","dependencies":{"variables":null},"inputMode":"","rawMeta":{"type":2},"type":"literal"}},"left":{},"name":"responseFormat","right":{}},{"input":{"type":"string","value":{"content":"豆包·1.5·Pro·32k","dependencies":{"variables":null},"inputMode":"","rawMeta":{"type":1},"type":"literal"}},"left":{},"name":"modleName","right":{}},{"input":{"type":"integer","value":{"content":"1737521813","dependencies":{"variables":null},"inputMode":"","rawMeta":{"type":2},"type":"literal"}},"left":{},"name":"modelType","right":{}},{"input":{"type":"string","value":{"content":"请以“{{title}}”作为国学主题方向\n","dependencies":{"variables":null},"inputMode":"","rawMeta":{"type":1},"type":"literal"}},"left":{},"name":"prompt","right":{}},{"input":{"type":"boolean","value":{"content":false,"dependencies":{"variables":null},"inputMode":"","rawMeta":{"type":3},"type":"literal"}},"left":{},"name":"enableChatHistory","right":{}},{"input":{"type":"integer","value":{"content":"3","dependencies":{"variables":null},"inputMode":"","rawMeta":{"type":2},"type":"literal"}},"left":{},"name":"chatHistoryRound","right":{}},{"input":{"type":"string","value":{"content":"# 角色\n你是一位国学知识资深创作者，擅长制作国学相关视频内容，对各类国学经典有着深入的理解和研究，能够以生动且富有内涵的方式将国学智慧呈现给大众。\n\n## 技能\n### 技能 1: 生成国学文案\n-目标：依据用户提供的国学主题方向，创作具有启发性和实用性的的国学科普文章\n-文案结构：采用总分总结构。开篇点明主题，阐述该主题在国学中的重要地位或意义；中间部分详细引经据典，结合具体的国学故事、人物事迹等进行深入解读，多角度展现主题所蕴含的国学思想；结尾总结升华，强调该主题对当代生活和个人修养的启示与价值。\n-案例选取：从国学经典著作、历史典故中选取恰当的案例，对案例进行清晰的背景介绍、情节描述以及所体现的国学道理分析。\n-语言风格：保持古朴典雅与通俗易懂的平衡，适当引用经典原文并加以准确的白话文翻译和解释，关键的国学概念突出阐述，确保段落间逻辑连贯、层次分明。\n-论证方式：紧密围绕国学体系展开，遵循传统国学的理念和价值观，注重理论与实例相结合，避免过度解读或歪曲。\n-输出格式：采用合理长短句结构，直接输出符合要求的国学文案，不需要数字分段，一个标题和文案内容。\n输出json格式示例：\n{\n     \"title\":<标题>,\n     \"content\":<文案内容>\n}\n\n\n## 限制\n- 所生成的内容需符合国学知识体系，逻辑严谨，准确传达国学思想。\n- 仅围绕国学相关内容进行创作，不涉及与国学无关的话题。 ","dependencies":{"variables":null},"inputMode":"","rawMeta":{"type":1},"type":"literal"}},"left":{},"name":"systemPrompt","right":{}},{"input":{"type":"string","value":{"content":"","dependencies":{"variables":null},"inputMode":"","rawMeta":{"type":1},"type":"literal"}},"left":{},"name":"stableSystemPrompt","right":{}},{"input":{"type":"boolean","value":{"content":false,"dependencies":{"variables":null},"inputMode":"","rawMeta":{"type":3},"type":"literal"}},"left":{},"name":"canContinue","right":{}}],"settingOnError":{"processType":1,"switch":false,"timeoutMs":600000}},"nodeMeta":{"description":"调用大语言模型,使用变量和提示词生成回复","icon":"https://lf3-static.bytednsdoc.com/obj/eden-cn/dvsmryvd_avi_dvsm/ljhwZthlaukjlkulzlp/icon/icon-LLM-v2.jpg","title":"大模型_国学视频文案"},"outputs":[{"input":{},"name":"title","required":false,"type":"string"},{"input":{},"name":"content","required":false,"type":"string"}],"settings":null,"version":"3"},"edges":null,"id":"152455","meta":{"canvasPosition":{"x":0,"y":0},"defaultCollapsed":false,"position":{"x":-4194.456355283308,"y":92.51454823889745}},"type":"3","_temp":{"bounds":{"x":0,"y":0,"width":0,"height":0}}},{"blocks":[{"blocks":[],"data":{"inputs":{"inputParameters":[{"input":{"type":"string","value":{"content":{"blockID":"180681","name":"list.desc_promopt","source":"block-output"},"rawMeta":{"type":1},"type":"ref"}},"name":"desc_info"}],"modelSetting":{"custom_ratio":{"height":1024,"width":576},"ddim_steps":30,"model":8},"prompt":{"negative_prompt":"文字，乱码","prompt":"{{desc_info}}"},"references":[],"settingOnError":{"processType":1,"retryTimes":0,"timeoutMs":60000}},"nodeMeta":{"description":"通过文字描述/添加参考图生成图片","icon":"https://lf3-static.bytednsdoc.com/obj/eden-cn/dvsmryvd_avi_dvsm/ljhwZthlaukjlkulzlp/icon/icon-ImageGeneration-v2.jpg","mainColor":"#FF4DC3","subTitle":"图像生成","title":"图像生成"},"outputs":[{"assistType":2,"name":"data","type":"string"},{"name":"msg","type":"string"}]},"edges":null,"id":"126048","meta":{"canvasPosition":{"x":0,"y":0},"defaultCollapsed":false,"position":{"x":180,"y":0}},"type":"16"}],"data":{"inputs":{"batchSize":{"type":"integer","value":{"content":"100","type":"literal"}},"concurrentSize":{"type":"integer","value":{"content":2,"rawMeta":{"type":2},"type":"literal"}},"inputParameters":[{"input":{"schema":{"schema":[{"name":"story_name","type":"string"},{"name":"desc","type":"string"},{"name":"cap","type":"string"},{"name":"desc_promopt","type":"string"}],"type":"object"},"type":"list","value":{"content":{"blockID":"173538","name":"list","source":"block-output"},"rawMeta":{"type":103},"type":"ref"}},"name":"list"}]},"nodeMeta":{"description":"通过设定批量运行次数和逻辑，运行批处理体内的任务","icon":"https://lf3-static.bytednsdoc.com/obj/eden-cn/dvsmryvd_avi_dvsm/ljhwZthlaukjlkulzlp/icon/icon-Batch-v2.jpg","mainColor":"#00B2B2","subTitle":"批处理","title":"批处理"},"outputs":[{"input":{"assistType":2,"schema":{"type":"string"},"type":"list","value":{"content":{"blockID":"126048","name":"data","source":"block-output"},"rawMeta":{"type":7},"type":"ref"}},"name":"data_list"}]},"edges":[{"sourceNodeID":"180681","sourcePortID":"batch-function-inline-output","targetNodeID":"126048"},{"sourceNodeID":"126048","sourcePortID":"","targetNodeID":"180681","targetPortID":"batch-function-inline-input"}],"id":"180681","meta":{"canvasPosition":{"x":-2434.4563552833074,"y":413.21454823889746},"defaultCollapsed":false,"position":{"x":-2254.4563552833074,"y":118.51454823889745}},"type":"28","_temp":{"bounds":{"x":0,"y":0,"width":0,"height":0}}},{"blocks":[],"data":{"inputs":{"callTransferVoice":true,"chatHistoryWriting":"historyWrite","content":{"type":"string","value":{"content":"正在生成文案...","type":"literal"}},"inputParameters":[],"streamingOutput":false},"nodeMeta":{"description":"节点从“消息”更名为“输出”，支持中间过程的消息输出，支持流式和非流式两种方式","icon":"https://lf3-static.bytednsdoc.com/obj/eden-cn/dvsmryvd_avi_dvsm/ljhwZthlaukjlkulzlp/icon/icon-Output-v2.jpg","mainColor":"#5C62FF","subTitle":"输出","title":"输出"}},"edges":null,"id":"136025","meta":{"canvasPosition":{"x":0,"y":0},"defaultCollapsed":false,"position":{"x":-4654.456355283308,"y":118.51454823889745}},"type":"13","_temp":{"bounds":{"x":0,"y":0,"width":0,"height":0}}},{"blocks":[],"data":{"inputs":{"callTransferVoice":true,"chatHistoryWriting":"historyWrite","content":{"type":"string","value":{"content":"正在生成画面配图...","type":"literal"}},"inputParameters":[],"streamingOutput":false},"nodeMeta":{"description":"节点从“消息”更名为“输出”，支持中间过程的消息输出，支持流式和非流式两种方式","icon":"https://lf3-static.bytednsdoc.com/obj/eden-cn/dvsmryvd_avi_dvsm/ljhwZthlaukjlkulzlp/icon/icon-Output-v2.jpg","mainColor":"#5C62FF","subTitle":"输出","title":"输出_1"}},"edges":null,"id":"163129","meta":{"canvasPosition":{"x":0,"y":0},"defaultCollapsed":false,"position":{"x":-2814.4563552833074,"y":118.51454823889745}},"type":"13","_temp":{"bounds":{"x":0,"y":0,"width":0,"height":0}}},{"blocks":[],"data":{"inputs":{"inputParameters":[{"input":{"type":"string","value":{"content":{"blockID":"152455","name":"content","source":"block-output"},"dependencies":{"variables":null},"inputMode":"","rawMeta":{"type":1},"type":"ref"}},"left":{},"name":"content","right":{}},{"input":{"type":"string","value":{"content":{"blockID":"152455","name":"title","source":"block-output"},"dependencies":{"variables":null},"inputMode":"","rawMeta":{"type":1},"type":"ref"}},"left":{},"name":"title","right":{}}],"llmParam":[{"input":{"type":"float","value":{"content":"0.8","dependencies":{"variables":null},"inputMode":"","rawMeta":{"type":4},"type":"literal"}},"left":{},"name":"temperature","right":{}},{"input":{"type":"integer","value":{"content":"4096","dependencies":{"variables":null},"inputMode":"","rawMeta":{"type":2},"type":"literal"}},"left":{},"name":"maxTokens","right":{}},{"input":{"type":"integer","value":{"content":"2","dependencies":{"variables":null},"inputMode":"","rawMeta":{"type":2},"type":"literal"}},"left":{},"name":"responseFormat","right":{}},{"input":{"type":"string","value":{"content":"豆包·1.5·Pro·32k","dependencies":{"variables":null},"inputMode":"","rawMeta":{"type":1},"type":"literal"}},"left":{},"name":"modleName","right":{}},{"input":{"type":"integer","value":{"content":"1737521813","dependencies":{"variables":null},"inputMode":"","rawMeta":{"type":2},"type":"literal"}},"left":{},"name":"modelType","right":{}},{"input":{"type":"string","value":{"content":"balance","dependencies":{"variables":null},"inputMode":"","rawMeta":{"type":1},"type":"literal"}},"left":{},"name":"generationDiversity","right":{}},{"input":{"type":"string","value":{"content":"国学文案内容：\n{{content}}","dependencies":{"variables":null},"inputMode":"","rawMeta":{"type":1},"type":"literal"}},"left":{},"name":"prompt","right":{}},{"input":{"type":"boolean","value":{"content":false,"dependencies":{"variables":null},"inputMode":"","rawMeta":{"type":3},"type":"literal"}},"left":{},"name":"enableChatHistory","right":{}},{"input":{"type":"integer","value":{"content":"3","dependencies":{"variables":null},"inputMode":"","rawMeta":{"type":2},"type":"literal"}},"left":{},"name":"chatHistoryRound","right":{}},{"input":{"type":"string","value":{"content":"# 角色 \n视频分镜描述专家\n\n## 技能  根据文章内容创作视频分镜描述\n1. 依据用户提供的国学科普文章内容，创作国学视频分镜描述。\n- [分镜描述]要求：视频画面符合国学风格，画面极简、清晰，画面描述需要清晰、细致体现各个情节细节。\n2. 生成[分镜图像提示词]，生成要求：\n[分镜图像提 示词]要求：Prompt : 采用传统工笔技法绘制，在仿古宣纸纹理背景上呈现具有东方韵味的简逸人物。以墨色骨法勾勒人物轮廓，线条蕴含书法笔意，施以丹青设色之法，着朱砂、石青、赭黄等传统矿物色于素衣之上。人物造型取法汉代画像石之简朴动态，背景融入水墨氤氲的祥云纹样，画面四隅点缀金石篆刻印章与梅花小景，整体营造出墨彩交融、文气盎然的古典美学意境. [PROMPT]\nGeneric prompt using LLM: Modify the following prompt for a different scene in which [PROMPT] : [分镜描述]\n3. 输出JSON格式：story_name=分镜名称，desc=分镜描述，cap=对应字幕文案 ，desc_promopt=分镜图像提示词\n输出示例：\n[\n{\n    \"story_name\":\"分镜名称\"\n    \"desc\":\"分镜描述\",\n    \"cap\":\"对应字幕文案\",\n    \"desc_promopt\":\"分镜图像提示词\"\n},...\n]\n\n## 限制\n- 视频文案及分镜描述必须一致，且国学风格呈现。","dependencies":{"variables":null},"inputMode":"","rawMeta":{"type":1},"type":"literal"}},"left":{},"name":"systemPrompt","right":{}},{"input":{"type":"string","value":{"content":"","dependencies":{"variables":null},"inputMode":"","rawMeta":{"type":1},"type":"literal"}},"left":{},"name":"stableSystemPrompt","right":{}},{"input":{"type":"boolean","value":{"content":false,"dependencies":{"variables":null},"inputMode":"","rawMeta":{"type":3},"type":"literal"}},"left":{},"name":"canContinue","right":{}}],"settingOnError":{"processType":1,"switch":false,"timeoutMs":600000}},"nodeMeta":{"description":"调用大语言模型,使用变量和提示词生成回复","icon":"https://lf3-static.bytednsdoc.com/obj/eden-cn/dvsmryvd_avi_dvsm/ljhwZthlaukjlkulzlp/icon/icon-LLM-v2.jpg","title":"大模型_分镜画面描述"},"outputs":[{"input":{},"name":"list","required":false,"schema":{"schema":[{"name":"story_name","type":"string"},{"name":"desc","type":"string"},{"name":"cap","type":"string"},{"name":"desc_promopt","type":"string"}],"type":"object"},"type":"list"}],"settings":null,"version":"3"},"edges":null,"id":"173538","meta":{"canvasPosition":{"x":0,"y":0},"defaultCollapsed":false,"position":{"x":-3274.4563552833074,"y":92.51454823889745}},"type":"3","_temp":{"bounds":{"x":0,"y":0,"width":0,"height":0}}},{"blocks":[{"blocks":[],"data":{"inputs":{"apiParam":[{"input":{"type":"string","value":{"content":"7426655854067367946","rawMeta":{"type":1},"type":"literal"}},"name":"apiID"},{"input":{"type":"string","value":{"content":"speech_synthesis","rawMeta":{"type":1},"type":"literal"}},"name":"apiName"},{"input":{"type":"string","value":{"content":"7426655854067351562","rawMeta":{"type":1},"type":"literal"}},"name":"pluginID"},{"input":{"type":"string","value":{"content":"语音合成","rawMeta":{"type":1},"type":"literal"}},"name":"pluginName"},{"input":{"type":"string","value":{"content":"","rawMeta":{"type":1},"type":"literal"}},"name":"pluginVersion"},{"input":{"type":"string","value":{"content":"","rawMeta":{"type":1},"type":"literal"}},"name":"tips"},{"input":{"type":"string","value":{"content":"","rawMeta":{"type":1},"type":"literal"}},"name":"outDocLink"}],"inputDefs":[{"defaultValue":1,"description":"语速，范围是[0.2,3]，默认为1，通常保留一位小数即可, default value is 1","input":{},"name":"speed_ratio","required":false,"type":"float"},{"description":"要合成音频的文本内容","input":{},"name":"text","required":true,"type":"string"},{"assistType":12,"description":"voice id","input":{},"name":"voice_id","required":false,"type":"string"},{"description":"语音语种，非必填，参考 https://bytedance.larkoffice.com/docx/WdDOdiB1BoRyBNxlkXWcn0n3nLc","input":{},"name":"language","required":false,"type":"string"},{"defaultValue":"爽快思思/Skye","description":"音色ID，默认为爽快思思/Skye。详细音色列表参考 https://bytedance.larkoffice.com/docx/WdDOdiB1BoRyBNxlkXWcn0n3nLc, default value is 爽快思思/Skye","input":{},"name":"speaker_id","required":false,"type":"string"}],"inputParameters":[{"input":{"type":"string","value":{"content":{"blockID":"169595","name":"input.cap","source":"block-output"},"rawMeta":{"type":1},"type":"ref"}},"name":"text"},{"input":{"type":"float","value":{"content":0.9,"rawMeta":{"type":4},"type":"literal"}},"name":"speed_ratio"},{"input":{"assistType":12,"type":"string","value":{"content":"7468512265151741979","rawMeta":{"fileName":"擎苍","type":18},"type":"literal"}},"name":"voice_id"}],"settingOnError":{"processType":1,"retryTimes":0,"timeoutMs":180000}},"nodeMeta":{"description":"根据音色和文本合成音频","icon":"https://lf3-static.bytednsdoc.com/obj/eden-cn/dvsmryvd_avi_dvsm/ljhwZthlaukjlkulzlp/icon/icon-Plugin-v2.jpg","subtitle":"语音合成:speech_synthesis","title":"speech_synthesis"},"outputs":[{"name":"log_id","required":false,"type":"string"},{"name":"msg","required":false,"type":"string"},{"name":"code","required":false,"type":"float"},{"name":"data","required":false,"schema":[{"name":"link","required":false,"type":"string"}],"type":"object"}]},"edges":null,"id":"122703","meta":{"canvasPosition":{"x":0,"y":0},"defaultCollapsed":false,"position":{"x":180,"y":0}},"type":"4"},{"blocks":[],"data":{"inputs":{"apiParam":[{"input":{"type":"string","value":{"content":"7474863657353117750","rawMeta":{"type":1},"type":"literal"}},"name":"apiID"},{"input":{"type":"string","value":{"content":"get_audio_duration","rawMeta":{"type":1},"type":"literal"}},"name":"apiName"},{"input":{"type":"string","value":{"content":"7457837925833801768","rawMeta":{"type":1},"type":"literal"}},"name":"pluginID"},{"input":{"type":"string","value":{"content":"视频合成_剪映小助手","rawMeta":{"type":1},"type":"literal"}},"name":"pluginName"},{"input":{"type":"string","value":{"content":"","rawMeta":{"type":1},"type":"literal"}},"name":"pluginVersion"},{"input":{"type":"string","value":{"content":"","rawMeta":{"type":1},"type":"literal"}},"name":"tips"},{"input":{"type":"string","value":{"content":"","rawMeta":{"type":1},"type":"literal"}},"name":"outDocLink"}],"inputDefs":[{"description":"音频链接","input":{},"name":"mp3_url","required":true,"type":"string"}],"inputParameters":[{"input":{"type":"string","value":{"content":{"blockID":"122703","name":"data.link","source":"block-output"},"rawMeta":{"type":1},"type":"ref"}},"name":"mp3_url"}],"settingOnError":{"processType":1,"retryTimes":0,"timeoutMs":180000}},"nodeMeta":{"description":"获取音频时长","icon":"https://lf3-static.bytednsdoc.com/obj/eden-cn/dvsmryvd_avi_dvsm/ljhwZthlaukjlkulzlp/icon/icon-Plugin-v2.jpg","subtitle":"视频合成_剪映小助手:get_audio_duration","title":"get_audio_duration"},"outputs":[{"name":"message","required":false,"type":"string"},{"name":"duration","required":false,"type":"integer"}]},"edges":null,"id":"199916","meta":{"canvasPosition":{"x":0,"y":0},"defaultCollapsed":false,"position":{"x":640,"y":0}},"type":"4"}],"data":{"inputs":{"inputParameters":[{"input":{"schema":{"schema":[{"name":"story_name","type":"string"},{"name":"desc","type":"string"},{"name":"cap","type":"string"},{"name":"desc_promopt","type":"string"}],"type":"object"},"type":"list","value":{"content":{"blockID":"173538","name":"list","source":"block-output"},"rawMeta":{"type":103},"type":"ref"}},"name":"input"}],"loopCount":{"type":"integer","value":{"content":"10","type":"literal"}},"loopType":"array","variableParameters":[]},"nodeMeta":{"description":"用于通过设定循环次数和逻辑，重复执行一系列任务","icon":"https://lf3-static.bytednsdoc.com/obj/eden-cn/dvsmryvd_avi_dvsm/ljhwZthlaukjlkulzlp/icon/icon-Loop-v2.jpg","mainColor":"#00B2B2","subTitle":"循环","title":"循环"},"outputs":[{"input":{"schema":{"type":"string"},"type":"list","value":{"content":{"blockID":"122703","name":"data.link","source":"block-output"},"rawMeta":{"type":1},"type":"ref"}},"name":"output"},{"input":{"schema":{"type":"integer"},"type":"list","value":{"content":{"blockID":"199916","name":"duration","source":"block-output"},"rawMeta":{"type":2},"type":"ref"}},"name":"duration_list"}]},"edges":[{"sourceNodeID":"169595","sourcePortID":"loop-function-inline-output","targetNodeID":"122703"},{"sourceNodeID":"122703","sourcePortID":"","targetNodeID":"199916"},{"sourceNodeID":"199916","sourcePortID":"","targetNodeID":"169595","targetPortID":"loop-function-inline-input"}],"id":"169595","meta":{"canvasPosition":{"x":-854.4563552833074,"y":426.21454823889746},"defaultCollapsed":false,"position":{"x":-444.4563552833074,"y":105.51454823889745}},"type":"21","_temp":{"bounds":{"x":0,"y":0,"width":0,"height":0}}},{"blocks":[],"data":{"inputs":{"apiParam":[{"input":{"type":"string","value":{"content":"7457837955684515874","rawMeta":{"type":1},"type":"literal"}},"name":"apiID"},{"input":{"type":"string","value":{"content":"create_draft","rawMeta":{"type":1},"type":"literal"}},"name":"apiName"},{"input":{"type":"string","value":{"content":"7457837925833801768","rawMeta":{"type":1},"type":"literal"}},"name":"pluginID"},{"input":{"type":"string","value":{"content":"视频合成_剪映小助手","rawMeta":{"type":1},"type":"literal"}},"name":"pluginName"},{"input":{"type":"string","value":{"content":"","rawMeta":{"type":1},"type":"literal"}},"name":"pluginVersion"},{"input":{"type":"string","value":{"content":"","rawMeta":{"type":1},"type":"literal"}},"name":"tips"},{"input":{"type":"string","value":{"content":"","rawMeta":{"type":1},"type":"literal"}},"name":"outDocLink"}],"inputDefs":[{"description":"高","input":{},"name":"height","required":false,"type":"integer"},{"description":"关联创作者","input":{},"name":"user_id","required":false,"type":"integer"},{"description":"宽","input":{},"name":"width","required":false,"type":"integer"}],"inputParameters":[{"input":{"type":"integer","value":{"content":1024,"rawMeta":{"type":2},"type":"literal"}},"name":"height"},{"input":{"type":"integer","value":{"content":10299,"rawMeta":{"type":2},"type":"literal"}},"name":"user_id"},{"input":{"type":"integer","value":{"content":576,"rawMeta":{"type":2},"type":"literal"}},"name":"width"}],"settingOnError":{"processType":1,"retryTimes":0,"timeoutMs":180000}},"nodeMeta":{"description":"插件入口-创建草稿","icon":"https://lf3-static.bytednsdoc.com/obj/eden-cn/dvsmryvd_avi_dvsm/ljhwZthlaukjlkulzlp/icon/icon-Plugin-v2.jpg","subtitle":"视频合成_剪映小助手:create_draft","title":"create_draft"},"outputs":[{"name":"draft_url","required":false,"type":"string"},{"name":"tip_url","required":false,"type":"string"}]},"edges":null,"id":"168118","meta":{"canvasPosition":{"x":0,"y":0},"defaultCollapsed":false,"position":{"x":2645.5436447166926,"y":118.51454823889745}},"type":"4","_temp":{"bounds":{"x":0,"y":0,"width":0,"height":0}}},{"blocks":[],"data":{"inputs":{"apiParam":[{"input":{"type":"string","value":{"content":"7457837925833834536","rawMeta":{"type":1},"type":"literal"}},"name":"apiID"},{"input":{"type":"string","value":{"content":"add_audios","rawMeta":{"type":1},"type":"literal"}},"name":"apiName"},{"input":{"type":"string","value":{"content":"7457837925833801768","rawMeta":{"type":1},"type":"literal"}},"name":"pluginID"},{"input":{"type":"string","value":{"content":"视频合成_剪映小助手","rawMeta":{"type":1},"type":"literal"}},"name":"pluginName"},{"input":{"type":"string","value":{"content":"","rawMeta":{"type":1},"type":"literal"}},"name":"pluginVersion"},{"input":{"type":"string","value":{"content":"","rawMeta":{"type":1},"type":"literal"}},"name":"tips"},{"input":{"type":"string","value":{"content":"","rawMeta":{"type":1},"type":"literal"}},"name":"outDocLink"}],"inputDefs":[{"description":"[{\"audio_url\": \"http://example.com/audio1.mp3\",\"duration\":120,\"start\":0,\"end\":12000000,\"audio_effect\":\"教堂\"}]","input":{},"name":"audio_infos","required":true,"type":"string"},{"description":"草稿地址，使用create_draft输出的draft_url即可","input":{},"name":"draft_url","required":true,"type":"string"}],"inputParameters":[{"input":{"type":"string","value":{"content":{"blockID":"180223","name":"infos","source":"block-output"},"rawMeta":{"type":1},"type":"ref"}},"name":"audio_infos"},{"input":{"type":"string","value":{"content":{"blockID":"168118","name":"draft_url","source":"block-output"},"rawMeta":{"type":1},"type":"ref"}},"name":"draft_url"}],"settingOnError":{"processType":1,"retryTimes":0,"timeoutMs":180000}},"nodeMeta":{"description":"批量添加音频","icon":"https://lf3-static.bytednsdoc.com/obj/eden-cn/dvsmryvd_avi_dvsm/ljhwZthlaukjlkulzlp/icon/icon-Plugin-v2.jpg","subtitle":"视频合成_剪映小助手:add_audios","title":"add_audios"},"outputs":[{"name":"audio_ids","required":false,"schema":{"type":"string"},"type":"list"},{"name":"draft_url","required":false,"type":"string"},{"name":"track_id","required":false,"type":"string"}]},"edges":null,"id":"125268","meta":{"canvasPosition":{"x":0,"y":0},"defaultCollapsed":false,"position":{"x":3105.5436447166926,"y":118.51454823889745}},"type":"4","_temp":{"bounds":{"x":0,"y":0,"width":0,"height":0}}},{"blocks":[],"data":{"inputs":{"code":"// 在这里，您可以通过 ‘params’  获取节点中的输入变量，并通过 'ret' 输出结果\n// 'params' 和 'ret' 已经被正确地注入到环境中\n// 下面是一个示例，获取节点输入中参数名为‘input’的值：\n// const input = params.input; \n// 下面是一个示例，输出一个包含多种数据类型的 'ret' 对象：\n// const ret = { \"name\": ‘小明’, \"hobbies\": [“看书”, “旅游”] };\nasync function main({ params }: Args): Promise<Output> {\n    const { image_list, list, audio_list, duration_list } = params;\n\n    // 处理音频数据\n    const audioData = [];\n    let audioStartTime = 0;\n    const videoTimelines = [];\n    let maxDuration = 0;\n\n    for (let i = 0; i < audio_list.length && i < duration_list.length; i++) {\n        const duration = duration_list[i];\n        audioData.push({\n            audio_url: audio_list[i],\n            duration:duration,\n            start: audioStartTime,\n            end: audioStartTime + duration,\n            audio_effect: \"教学\"\n        });\n        videoTimelines.push({\n            start: audioStartTime,\n            end: audioStartTime + duration\n        });\n        audioStartTime += duration;\n        maxDuration = audioStartTime;\n    }\n\n\n    \n    // 添加背景音乐\n    const bg_audio_list = [];\n    const bg_audio_timelines = [];\n    bg_audio_list.push(\"https://codel-agent.oss-cn-shanghai.aliyuncs.com/%E7%BA%AF%E9%9F%B3%E4%B9%90%20-%20%E9%AB%98%E5%B1%B1%E6%B5%81%E6%B0%B4%20%28%E5%8F%A4%E7%AD%9D%E7%89%88%29.mp3\");\n    bg_audio_timelines.push({\n        start: 0,\n        end: maxDuration + 2000000\n    });\n\n\n\n\n    // 处理图片数据\n    const imageData = [];\n    let imageStartTime = 0;\n\n    for (let i = 0; i < image_list.length && i < duration_list.length; i++) {\n        const duration = duration_list[i];\n        var last_duration = 0;\n        if(i==image_list.length-1)\n        {\n            last_duration = 2000000;\n        }\n        imageData.push({\n            image_url: image_list[i],\n            transition: \"叠化\",\n            width: 576,\n            height: 1024,\n            start: imageStartTime,\n            end: imageStartTime + duration +last_duration\n        });\n        imageStartTime += duration;\n    }\n\n\n    // 处理字幕数据\n    const captions = list.map(item => item.cap);\n    const subtitleDurations = duration_list;\n\n    const processedSubtitles = [];\n    const processedSubtitleDurations = [];\n\n    for (let i = 0; i < captions.length; i++) {\n        const text = captions[i];\n        const totalDuration = subtitleDurations[i];\n    \n        // 计算有效字符的数量（汉字、英文、数字）\n        const validChars = text.split('').filter(char => isChineseEnglishOrDigit(char));\n        const validCharCount = validChars.length;\n    \n        // 如果有效字符数量为0，则整个字幕片段的时长为0\n        if (validCharCount === 0) {\n            processedSubtitles.push(text);\n            processedSubtitleDurations.push(0);\n            continue;\n        }\n    \n        // 按照标点符号分割字幕\n        const subtitles = text.split(/[，。！,!?]/).filter(part => part.trim() !== '');\n        const subtitleCount = subtitles.length;\n    \n        if (subtitleCount > 0) {\n            // 根据有效字符数量计算每个字幕片段的时长\n            const perSubtitleDuration = totalDuration / subtitleCount;\n            for (let j = 0; j < subtitleCount; j++) {\n                processedSubtitles.push(subtitles[j]);\n                processedSubtitleDurations.push(perSubtitleDuration);\n            }\n        } else {\n            processedSubtitles.push(text);\n            processedSubtitleDurations.push(totalDuration);\n        }\n    }\n\n    // 处理字幕时间线\n    const textTimelines = [];\n    let textStartTime = 0;\n\n    for (const duration of processedSubtitleDurations) {\n        const endTime = textStartTime + duration;\n        textTimelines.push({\n            start: textStartTime,\n            end: endTime\n        });\n        textStartTime = endTime;\n    }\n\n    // 构建输出对象\n    const result = {\n        audio_list: JSON.stringify(audioData),\n        image_list: JSON.stringify(imageData),\n        timelines: videoTimelines,\n        text_timelines: textTimelines,\n        text_cap: processedSubtitles,\n        max_time: maxDuration,\n        bg_audio_list: bg_audio_list,\n        bg_autdo_timelines: bg_audio_timelines\n    };\n\n    return result;\n}\n\n// 定义一个辅助函数，用于判断字符是否是汉字、英文或数字\nfunction isChineseEnglishOrDigit(char) {\n    return /[\\u4e00-\\u9fa5a-zA-Z0-9]/.test(char);\n}","functionID":"38x4c13hlx2m4","inputParameters":[{"input":{"schema":{"type":"string"},"type":"list","value":{"content":{"blockID":"169595","name":"output","source":"block-output"},"dependencies":{"variables":null},"inputMode":"","rawMeta":{"type":99},"type":"ref"}},"left":{},"name":"audio_list","right":{}},{"input":{"schema":{"type":"integer"},"type":"list","value":{"content":{"blockID":"169595","name":"duration_list","source":"block-output"},"dependencies":{"variables":null},"inputMode":"","rawMeta":{"type":100},"type":"ref"}},"left":{},"name":"duration_list","right":{}},{"input":{"schema":{"assistType":2,"type":"string"},"type":"list","value":{"content":{"blockID":"180681","name":"data_list","source":"block-output"},"dependencies":{"variables":null},"inputMode":"","rawMeta":{"type":104},"type":"ref"}},"left":{},"name":"image_list","right":{}},{"input":{"schema":{"schema":[{"name":"story_name","type":"string"},{"name":"desc","type":"string"},{"name":"cap","type":"string"},{"name":"desc_promopt","type":"string"}],"type":"object"},"type":"list","value":{"content":{"blockID":"173538","name":"list","source":"block-output"},"dependencies":{"variables":null},"inputMode":"","rawMeta":{"type":103},"type":"ref"}},"left":{},"name":"list","right":{}}],"language":5,"settingOnError":{"processType":1,"switch":false,"timeoutMs":60000}},"nodeMeta":{"description":"编写代码，处理输入变量来生成返回值","icon":"https://lf3-static.bytednsdoc.com/obj/eden-cn/dvsmryvd_avi_dvsm/ljhwZthlaukjlkulzlp/icon/icon-Code-v2.jpg","title":"代码"},"outputs":[{"input":{},"name":"image_list","required":false,"type":"string"},{"input":{},"name":"timelines","required":false,"schema":{"schema":[{"name":"start","type":"integer"},{"name":"end","type":"integer"}],"type":"object"},"type":"list"},{"input":{},"name":"text_timelines","required":false,"schema":{"schema":[{"name":"start","type":"integer"},{"name":"end","type":"integer"}],"type":"object"},"type":"list"},{"input":{},"name":"text_cap","required":false,"schema":{"type":"string"},"type":"list"},{"input":{},"name":"max_time","required":false,"type":"integer"},{"input":{},"name":"bg_audio_list","required":false,"schema":{"type":"string"},"type":"list"},{"input":{},"name":"bg_autdo_timelines","required":false,"schema":{"schema":[{"name":"start","type":"integer"},{"name":"end","type":"integer"}],"type":"object"},"type":"list"}],"settings":null,"version":""},"edges":null,"id":"152586","meta":{"canvasPosition":{"x":0,"y":0},"defaultCollapsed":false,"position":{"x":345.5436447166926,"y":118.51454823889745}},"type":"5","_temp":{"bounds":{"x":0,"y":0,"width":0,"height":0}}},{"blocks":[],"data":{"inputs":{"apiParam":[{"input":{"type":"string","value":{"content":"7457837925833883688","rawMeta":{"type":1},"type":"literal"}},"name":"apiID"},{"input":{"type":"string","value":{"content":"add_images","rawMeta":{"type":1},"type":"literal"}},"name":"apiName"},{"input":{"type":"string","value":{"content":"7457837925833801768","rawMeta":{"type":1},"type":"literal"}},"name":"pluginID"},{"input":{"type":"string","value":{"content":"视频合成_剪映小助手","rawMeta":{"type":1},"type":"literal"}},"name":"pluginName"},{"input":{"type":"string","value":{"content":"","rawMeta":{"type":1},"type":"literal"}},"name":"pluginVersion"},{"input":{"type":"string","value":{"content":"","rawMeta":{"type":1},"type":"literal"}},"name":"tips"},{"input":{"type":"string","value":{"content":"","rawMeta":{"type":1},"type":"literal"}},"name":"outDocLink"}],"inputDefs":[{"description":"移动transform_y","input":{},"name":"transform_y","required":false,"type":"float"},{"description":"草稿地址，使用create_draft输出的draft_url即可","input":{},"name":"draft_url","required":true,"type":"string"},{"description":"查看说明：https://krxc4izye0.feishu.cn/wiki/Pgm9wXA4EipKhYkeEQJcLBlJnWb?from=from_copylink","input":{},"name":"image_infos","required":true,"type":"string"},{"description":"x缩放","input":{},"name":"scale_x","required":false,"type":"float"},{"description":"y缩放","input":{},"name":"scale_y","required":false,"type":"float"},{"description":"移动transform_x","input":{},"name":"transform_x","required":false,"type":"float"}],"inputParameters":[{"input":{"type":"string","value":{"content":{"blockID":"168118","name":"draft_url","source":"block-output"},"rawMeta":{"type":1},"type":"ref"}},"name":"draft_url"},{"input":{"type":"string","value":{"content":{"blockID":"152586","name":"image_list","source":"block-output"},"rawMeta":{"type":1},"type":"ref"}},"name":"image_infos"},{"input":{"type":"float","value":{"content":1,"rawMeta":{"type":4},"type":"literal"}},"name":"scale_x"},{"input":{"type":"float","value":{"content":1,"rawMeta":{"type":4},"type":"literal"}},"name":"scale_y"}],"settingOnError":{"processType":1,"retryTimes":0,"timeoutMs":180000}},"nodeMeta":{"description":"批量添加图片","icon":"https://lf3-static.bytednsdoc.com/obj/eden-cn/dvsmryvd_avi_dvsm/ljhwZthlaukjlkulzlp/icon/icon-Plugin-v2.jpg","subtitle":"视频合成_剪映小助手:add_images","title":"add_images"},"outputs":[{"name":"segment_ids","required":false,"schema":{"type":"string"},"type":"list"},{"name":"segment_infos","required":false,"schema":{"schema":[{"name":"id","required":false,"type":"string"},{"name":"start","required":false,"type":"integer"},{"name":"end","required":false,"type":"integer"}],"type":"object"},"type":"list"},{"name":"track_id","required":false,"type":"string"},{"name":"draft_url","required":false,"type":"string"},{"name":"image_ids","required":false,"schema":{"type":"string"},"type":"list"}]},"edges":null,"id":"159780","meta":{"canvasPosition":{"x":0,"y":0},"defaultCollapsed":false,"position":{"x":4025.5436447166926,"y":118.51454823889745}},"type":"4","_temp":{"bounds":{"x":0,"y":0,"width":0,"height":0}}},{"blocks":[],"data":{"inputs":{"apiParam":[{"input":{"type":"string","value":{"content":"7457837955684548642","rawMeta":{"type":1},"type":"literal"}},"name":"apiID"},{"input":{"type":"string","value":{"content":"save_draft","rawMeta":{"type":1},"type":"literal"}},"name":"apiName"},{"input":{"type":"string","value":{"content":"7457837925833801768","rawMeta":{"type":1},"type":"literal"}},"name":"pluginID"},{"input":{"type":"string","value":{"content":"视频合成_剪映小助手","rawMeta":{"type":1},"type":"literal"}},"name":"pluginName"},{"input":{"type":"string","value":{"content":"","rawMeta":{"type":1},"type":"literal"}},"name":"pluginVersion"},{"input":{"type":"string","value":{"content":"","rawMeta":{"type":1},"type":"literal"}},"name":"tips"},{"input":{"type":"string","value":{"content":"","rawMeta":{"type":1},"type":"literal"}},"name":"outDocLink"}],"inputDefs":[{"description":"草稿地址，使用create_draft输出的draft_url即可","input":{},"name":"draft_url","required":true,"type":"string"},{"description":"用户ID。如果填写了这个ID，新用户产生的月费就会按照比例归属到这个账号下。","input":{},"name":"user_id","required":false,"type":"integer"}],"inputParameters":[{"input":{"type":"string","value":{"content":{"blockID":"168118","name":"draft_url","source":"block-output"},"rawMeta":{"type":1},"type":"ref"}},"name":"draft_url"},{"input":{"type":"integer","value":{"content":10299,"rawMeta":{"type":2},"type":"literal"}},"name":"user_id"}],"settingOnError":{"processType":1,"retryTimes":0,"timeoutMs":180000}},"nodeMeta":{"description":"保存草稿\n","icon":"https://lf3-static.bytednsdoc.com/obj/eden-cn/dvsmryvd_avi_dvsm/ljhwZthlaukjlkulzlp/icon/icon-Plugin-v2.jpg","subtitle":"视频合成_剪映小助手:save_draft","title":"save_draft"},"outputs":[{"name":"draft_url","required":false,"type":"string"},{"name":"message","required":false,"type":"string"}]},"edges":null,"id":"104782","meta":{"canvasPosition":{"x":0,"y":0},"defaultCollapsed":false,"position":{"x":4945.543644716692,"y":118.51454823889745}},"type":"4","_temp":{"bounds":{"x":0,"y":0,"width":0,"height":0}}},{"blocks":[],"data":{"inputs":{"apiParam":[{"input":{"type":"string","value":{"content":"7475829177439158307","rawMeta":{"type":1},"type":"literal"}},"name":"apiID"},{"input":{"type":"string","value":{"content":"audio_infos","rawMeta":{"type":1},"type":"literal"}},"name":"apiName"},{"input":{"type":"string","value":{"content":"7475829177439109155","rawMeta":{"type":1},"type":"literal"}},"name":"pluginID"},{"input":{"type":"string","value":{"content":"剪映小助手数据生成器","rawMeta":{"type":1},"type":"literal"}},"name":"pluginName"},{"input":{"type":"string","value":{"content":"","rawMeta":{"type":1},"type":"literal"}},"name":"pluginVersion"},{"input":{"type":"string","value":{"content":"","rawMeta":{"type":1},"type":"literal"}},"name":"tips"},{"input":{"type":"string","value":{"content":"","rawMeta":{"type":1},"type":"literal"}},"name":"outDocLink"}],"inputDefs":[{"description":"特效音，eg：教堂，默认无","input":{},"name":"audio_effect","required":false,"type":"string"},{"description":"音频列表","input":{},"name":"mp3_urls","required":true,"schema":{"assistType":0,"type":"string"},"type":"list"},{"description":"时间线","input":{},"name":"timelines","required":true,"schema":{"schema":[{"description":"结束时间","input":{},"name":"end","required":true,"type":"integer"},{"description":"开始时间","input":{},"name":"start","required":true,"type":"integer"}],"type":"object"},"type":"list"},{"description":"音量大小，0-10,默认1","input":{},"name":"volume","required":false,"type":"float"}],"inputParameters":[{"input":{"schema":{"type":"string"},"type":"list","value":{"content":{"blockID":"169595","name":"output","source":"block-output"},"rawMeta":{"type":99},"type":"ref"}},"name":"mp3_urls"},{"input":{"schema":{"schema":[{"name":"start","type":"integer"},{"name":"end","type":"integer"}],"type":"object"},"type":"list","value":{"content":{"blockID":"152586","name":"timelines","source":"block-output"},"rawMeta":{"type":103},"type":"ref"}},"name":"timelines"}],"settingOnError":{"processType":1,"retryTimes":0,"timeoutMs":180000}},"nodeMeta":{"description":"根据时间线制作音频数据","icon":"https://lf3-static.bytednsdoc.com/obj/eden-cn/dvsmryvd_avi_dvsm/ljhwZthlaukjlkulzlp/icon/icon-Plugin-v2.jpg","subtitle":"剪映小助手数据生成器:audio_infos","title":"audio_infos"},"outputs":[{"name":"infos","required":false,"type":"string"}]},"edges":null,"id":"180223","meta":{"canvasPosition":{"x":0,"y":0},"defaultCollapsed":false,"position":{"x":1265.5436447166926,"y":118.51454823889745}},"type":"4","_temp":{"bounds":{"x":0,"y":0,"width":0,"height":0}}},{"blocks":[],"data":{"inputs":{"apiParam":[{"input":{"type":"string","value":{"content":"7457837925833850920","rawMeta":{"type":1},"type":"literal"}},"name":"apiID"},{"input":{"type":"string","value":{"content":"add_captions","rawMeta":{"type":1},"type":"literal"}},"name":"apiName"},{"input":{"type":"string","value":{"content":"7457837925833801768","rawMeta":{"type":1},"type":"literal"}},"name":"pluginID"},{"input":{"type":"string","value":{"content":"视频合成_剪映小助手","rawMeta":{"type":1},"type":"literal"}},"name":"pluginName"},{"input":{"type":"string","value":{"content":"","rawMeta":{"type":1},"type":"literal"}},"name":"pluginVersion"},{"input":{"type":"string","value":{"content":"","rawMeta":{"type":1},"type":"literal"}},"name":"tips"},{"input":{"type":"string","value":{"content":"","rawMeta":{"type":1},"type":"literal"}},"name":"outDocLink"}],"inputDefs":[{"description":"字体列表：https://krxc4izye0.feishu.cn/wiki/SmnrwabXriG7JckEzyGcChk4nDd","input":{},"name":"font","required":false,"type":"string"},{"description":"默认：15","input":{},"name":"font_size","required":false,"type":"integer"},{"description":"scale_x缩放","input":{},"name":"scale_x","required":false,"type":"float"},{"description":"0 默认。1富文本样式","input":{},"name":"style_text","required":false,"type":"integer"},{"description":"transform_x位置","input":{},"name":"transform_x","required":false,"type":"float"},{"description":"transform_y位置","input":{},"name":"transform_y","required":false,"type":"float"},{"description":"查看说明：https://krxc4izye0.feishu.cn/wiki/HhQrw3BFhi1XGOkkJCBcfkqGnwf?from=from_copylink","input":{},"name":"captions","required":true,"type":"string"},{"description":"草稿地址，使用create_draft输出的draft_url即可","input":{},"name":"draft_url","required":true,"type":"string"},{"description":"字间距，默认0","input":{},"name":"letter_spacing","required":false,"type":"float"},{"description":"行间距，默认0","input":{},"name":"line_spacing","required":false,"type":"float"},{"description":"scale_y缩放","input":{},"name":"scale_y","required":false,"type":"float"},{"description":"文字颜色：#ff1837","input":{},"name":"text_color","required":false,"type":"string"},{"description":"字幕的对齐方式，0左对齐，1 居中对齐，2右对齐","input":{},"name":"alignment","required":false,"type":"integer"},{"description":"边框颜色，eg：#fe8a80","input":{},"name":"border_color","required":false,"type":"string"}],"inputParameters":[{"input":{"type":"string","value":{"content":{"blockID":"180947","name":"infos","source":"block-output"},"rawMeta":{"type":1},"type":"ref"}},"name":"captions"},{"input":{"type":"string","value":{"content":{"blockID":"168118","name":"draft_url","source":"block-output"},"rawMeta":{"type":1},"type":"ref"}},"name":"draft_url"},{"input":{"type":"integer","value":{"content":1,"rawMeta":{"type":2},"type":"literal"}},"name":"alignment"},{"input":{"type":"string","value":{"content":"#000000","rawMeta":{"type":1},"type":"literal"}},"name":"border_color"},{"input":{"type":"integer","value":{"content":12,"rawMeta":{"type":2},"type":"literal"}},"name":"font_size"},{"input":{"type":"integer","value":{"content":0,"rawMeta":{"type":2},"type":"literal"}},"name":"style_text"},{"input":{"type":"string","value":{"content":"#ffffff","rawMeta":{"type":1},"type":"literal"}},"name":"text_color"},{"input":{"type":"float","value":{"content":0,"rawMeta":{"type":4},"type":"literal"}},"name":"transform_x"},{"input":{"type":"float","value":{"content":0,"rawMeta":{"type":4},"type":"literal"}},"name":"transform_y"}],"settingOnError":{"processType":1,"retryTimes":0,"timeoutMs":180000}},"nodeMeta":{"description":"批量添加字幕","icon":"https://p26-flow-product-sign.byteimg.com/tos-cn-i-13w3uml6bg/324427c7589a426286a9774fa69f64a2~tplv-13w3uml6bg-resize:128:128.image?rk3s=2e2596fd&x-expires=1744464780&x-signature=qS0o%2FY1NDMFTjtJAQ%2FHNSTjQEzw%3D","subtitle":"视频合成_剪映小助手:add_captions","title":"add_captions"},"outputs":[{"name":"draft_url","required":false,"type":"string"},{"name":"segment_ids","required":false,"schema":{"type":"string"},"type":"list"},{"name":"segment_infos","required":false,"schema":{"schema":[{"name":"end","required":false,"type":"integer"},{"name":"id","required":false,"type":"string"},{"name":"start","required":false,"type":"integer"}],"type":"object"},"type":"list"},{"name":"text_ids","required":false,"schema":{"type":"string"},"type":"list"},{"name":"track_id","required":false,"type":"string"}]},"edges":null,"id":"158201","meta":{"canvasPosition":{"x":0,"y":0},"defaultCollapsed":false,"position":{"x":4485.543644716692,"y":118.51454823889745}},"type":"4","_temp":{"bounds":{"x":0,"y":0,"width":0,"height":0}}},{"blocks":[],"data":{"inputs":{"apiParam":[{"input":{"type":"string","value":{"content":"7475829177439191075","rawMeta":{"type":1},"type":"literal"}},"name":"apiID"},{"input":{"type":"string","value":{"content":"caption_infos","rawMeta":{"type":1},"type":"literal"}},"name":"apiName"},{"input":{"type":"string","value":{"content":"7475829177439109155","rawMeta":{"type":1},"type":"literal"}},"name":"pluginID"},{"input":{"type":"string","value":{"content":"剪映小助手数据生成器","rawMeta":{"type":1},"type":"literal"}},"name":"pluginName"},{"input":{"type":"string","value":{"content":"","rawMeta":{"type":1},"type":"literal"}},"name":"pluginVersion"},{"input":{"type":"string","value":{"content":"","rawMeta":{"type":1},"type":"literal"}},"name":"tips"},{"input":{"type":"string","value":{"content":"","rawMeta":{"type":1},"type":"literal"}},"name":"outDocLink"}],"inputDefs":[{"description":"入场动画时长","input":{},"name":"in_animation_duration","required":false,"type":"integer"},{"description":"关键词颜色","input":{},"name":"keyword_color","required":false,"type":"string"},{"description":"关键词字大小","input":{},"name":"keyword_font_size","required":false,"type":"integer"},{"description":"对应剪映的循环动画名字，多个动画请用英文|分割，比如：扫光|晃动","input":{},"name":"loop_animation","required":false,"type":"string"},{"description":"循环动画时长","input":{},"name":"loop_animation_duration","required":false,"type":"integer"},{"description":"出场动画时长","input":{},"name":"out_animation_duration","required":false,"type":"integer"},{"description":"文字大小","input":{},"name":"font_size","required":false,"type":"integer"},{"description":"对应剪映的入场动画名字，多个动画请用英文|分割，比如：飞入|放大","input":{},"name":"in_animation","required":false,"type":"string"},{"description":"文本里面的重点词列表","input":{},"name":"keywords","required":false,"schema":{"assistType":0,"type":"string"},"type":"list"},{"description":"对应剪映的出场动画名字，多个动画请用英文|分割，比如：消散|闭幕","input":{},"name":"out_animation","required":false,"type":"string"},{"description":"文本列表","input":{},"name":"texts","required":true,"schema":{"assistType":0,"type":"string"},"type":"list"},{"description":"时间节点，只接收结构：[{\"start\":0,\"end\":4612}]，一般从audio_timeline节点的输出获取","input":{},"name":"timelines","required":true,"schema":{"schema":[{"description":"结束时间","input":{},"name":"end","required":true,"type":"integer"},{"description":"开始时间","input":{},"name":"start","required":true,"type":"integer"}],"type":"object"},"type":"list"}],"inputParameters":[{"input":{"schema":{"type":"string"},"type":"list","value":{"content":{"blockID":"152586","name":"text_cap","source":"block-output"},"rawMeta":{"type":99},"type":"ref"}},"name":"texts"},{"input":{"schema":{"schema":[{"name":"start","type":"integer"},{"name":"end","type":"integer"}],"type":"object"},"type":"list","value":{"content":{"blockID":"152586","name":"text_timelines","source":"block-output"},"rawMeta":{"type":103},"type":"ref"}},"name":"timelines"},{"input":{"type":"integer","value":{"content":15,"rawMeta":{"type":2},"type":"literal"}},"name":"font_size"},{"input":{"type":"string","value":{"content":"渐显","rawMeta":{"type":1},"type":"literal"}},"name":"in_animation"},{"input":{"type":"string","value":{"content":"渐隐","rawMeta":{"type":1},"type":"literal"}},"name":"out_animation"}],"settingOnError":{"processType":1,"retryTimes":0,"timeoutMs":180000}},"nodeMeta":{"description":"根据时间线制作字幕数据","icon":"https://p9-flow-product-sign.byteimg.com/tos-cn-i-13w3uml6bg/6a57866c6eca488eb6a78e3cdb16e668~tplv-13w3uml6bg-resize:128:128.image?rk3s=2e2596fd&x-expires=1744465010&x-signature=4iDDzKiufQ2Axl4wsESVJu8bc4A%3D","subtitle":"剪映小助手数据生成器:caption_infos","title":"caption_infos"},"outputs":[{"name":"infos","required":false,"type":"string"}]},"edges":null,"id":"180947","meta":{"canvasPosition":{"x":0,"y":0},"defaultCollapsed":false,"position":{"x":2185.5436447166926,"y":118.51454823889745}},"type":"4","_temp":{"bounds":{"x":0,"y":0,"width":0,"height":0}}},{"blocks":[],"data":{"inputs":{"callTransferVoice":true,"chatHistoryWriting":"historyWrite","content":{"type":"string","value":{"content":"正在生成视频分镜描述","type":"literal"}},"inputParameters":[],"streamingOutput":false},"nodeMeta":{"description":"节点从“消息”更名为“输出”，支持中间过程的消息输出，支持流式和非流式两种方式","icon":"https://lf3-static.bytednsdoc.com/obj/eden-cn/dvsmryvd_avi_dvsm/ljhwZthlaukjlkulzlp/icon/icon-Output-v2.jpg","mainColor":"#5C62FF","subTitle":"输出","title":"输出_2"}},"edges":null,"id":"154682","meta":{"canvasPosition":{"x":0,"y":0},"defaultCollapsed":false,"position":{"x":-3734.4563552833074,"y":118.51454823889745}},"type":"13","_temp":{"bounds":{"x":0,"y":0,"width":0,"height":0}}},{"blocks":[],"data":{"inputs":{"callTransferVoice":true,"chatHistoryWriting":"historyWrite","content":{"type":"string","value":{"content":"正在生成音频...","type":"literal"}},"inputParameters":[],"streamingOutput":false},"nodeMeta":{"description":"节点从“消息”更名为“输出”，支持中间过程的消息输出，支持流式和非流式两种方式","icon":"https://lf3-static.bytednsdoc.com/obj/eden-cn/dvsmryvd_avi_dvsm/ljhwZthlaukjlkulzlp/icon/icon-Output-v2.jpg","mainColor":"#5C62FF","subTitle":"输出","title":"输出_3"}},"edges":null,"id":"133547","meta":{"canvasPosition":{"x":0,"y":0},"defaultCollapsed":false,"position":{"x":-1234.4563552833074,"y":118.51454823889745}},"type":"13","_temp":{"bounds":{"x":0,"y":0,"width":0,"height":0}}},{"blocks":[],"data":{"inputs":{"callTransferVoice":true,"chatHistoryWriting":"historyWrite","content":{"type":"string","value":{"content":"视频编排中， 即将完成...","type":"literal"}},"inputParameters":[],"streamingOutput":false},"nodeMeta":{"description":"节点从“消息”更名为“输出”，支持中间过程的消息输出，支持流式和非流式两种方式","icon":"https://lf3-static.bytednsdoc.com/obj/eden-cn/dvsmryvd_avi_dvsm/ljhwZthlaukjlkulzlp/icon/icon-Output-v2.jpg","mainColor":"#5C62FF","subTitle":"输出","title":"输出_4"}},"edges":null,"id":"150526","meta":{"canvasPosition":{"x":0,"y":0},"defaultCollapsed":false,"position":{"x":805.5436447166926,"y":118.51454823889745}},"type":"13","_temp":{"bounds":{"x":0,"y":0,"width":0,"height":0}}},{"blocks":[],"data":{"inputs":{"apiParam":[{"input":{"type":"string","value":{"content":"7475829177439158307","rawMeta":{"type":1},"type":"literal"}},"name":"apiID"},{"input":{"type":"string","value":{"content":"audio_infos","rawMeta":{"type":1},"type":"literal"}},"name":"apiName"},{"input":{"type":"string","value":{"content":"7475829177439109155","rawMeta":{"type":1},"type":"literal"}},"name":"pluginID"},{"input":{"type":"string","value":{"content":"剪映小助手数据生成器","rawMeta":{"type":1},"type":"literal"}},"name":"pluginName"},{"input":{"type":"string","value":{"content":"","rawMeta":{"type":1},"type":"literal"}},"name":"pluginVersion"},{"input":{"type":"string","value":{"content":"","rawMeta":{"type":1},"type":"literal"}},"name":"tips"},{"input":{"type":"string","value":{"content":"","rawMeta":{"type":1},"type":"literal"}},"name":"outDocLink"}],"inputDefs":[{"description":"特效音，eg：教堂，默认无","input":{},"name":"audio_effect","required":false,"type":"string"},{"description":"音频列表","input":{},"name":"mp3_urls","required":true,"schema":{"assistType":0,"type":"string"},"type":"list"},{"description":"时间线","input":{},"name":"timelines","required":true,"schema":{"schema":[{"description":"结束时间","input":{},"name":"end","required":true,"type":"integer"},{"description":"开始时间","input":{},"name":"start","required":true,"type":"integer"}],"type":"object"},"type":"list"},{"description":"音量大小，0-10,默认1","input":{},"name":"volume","required":false,"type":"float"}],"inputParameters":[{"input":{"schema":{"type":"string"},"type":"list","value":{"content":{"blockID":"152586","name":"bg_audio_list","source":"block-output"},"rawMeta":{"type":99},"type":"ref"}},"name":"mp3_urls"},{"input":{"schema":{"schema":[{"name":"start","type":"integer"},{"name":"end","type":"integer"}],"type":"object"},"type":"list","value":{"content":{"blockID":"152586","name":"bg_autdo_timelines","source":"block-output"},"rawMeta":{"type":103},"type":"ref"}},"name":"timelines"}],"settingOnError":{"processType":1,"retryTimes":0,"timeoutMs":180000}},"nodeMeta":{"description":"根据时间线制作音频数据","icon":"https://p6-flow-product-sign.byteimg.com/tos-cn-i-13w3uml6bg/6a57866c6eca488eb6a78e3cdb16e668~tplv-13w3uml6bg-resize:128:128.image?rk3s=2e2596fd&x-expires=1744623822&x-signature=4mCcnbhFl3YCedz7AY7rqsEsdRo%3D","subtitle":"剪映小助手数据生成器:audio_infos","title":"audio_infos_1"},"outputs":[{"name":"infos","required":false,"type":"string"}]},"edges":null,"id":"195949","meta":{"canvasPosition":{"x":0,"y":0},"defaultCollapsed":false,"position":{"x":1725.5436447166926,"y":118.51454823889745}},"type":"4","_temp":{"bounds":{"x":0,"y":0,"width":0,"height":0}}},{"blocks":[],"data":{"inputs":{"apiParam":[{"input":{"type":"string","value":{"content":"7457837925833834536","rawMeta":{"type":1},"type":"literal"}},"name":"apiID"},{"input":{"type":"string","value":{"content":"add_audios","rawMeta":{"type":1},"type":"literal"}},"name":"apiName"},{"input":{"type":"string","value":{"content":"7457837925833801768","rawMeta":{"type":1},"type":"literal"}},"name":"pluginID"},{"input":{"type":"string","value":{"content":"视频合成_剪映小助手","rawMeta":{"type":1},"type":"literal"}},"name":"pluginName"},{"input":{"type":"string","value":{"content":"","rawMeta":{"type":1},"type":"literal"}},"name":"pluginVersion"},{"input":{"type":"string","value":{"content":"","rawMeta":{"type":1},"type":"literal"}},"name":"tips"},{"input":{"type":"string","value":{"content":"","rawMeta":{"type":1},"type":"literal"}},"name":"outDocLink"}],"inputDefs":[{"description":"[{\"audio_url\": \"http://example.com/audio1.mp3\",\"duration\":120,\"start\":0,\"end\":12000000,\"audio_effect\":\"教堂\"}]","input":{},"name":"audio_infos","required":true,"type":"string"},{"description":"草稿地址，使用create_draft输出的draft_url即可","input":{},"name":"draft_url","required":true,"type":"string"}],"inputParameters":[{"input":{"type":"string","value":{"content":{"blockID":"195949","name":"infos","source":"block-output"},"rawMeta":{"type":1},"type":"ref"}},"name":"audio_infos"},{"input":{"type":"string","value":{"content":{"blockID":"168118","name":"draft_url","source":"block-output"},"rawMeta":{"type":1},"type":"ref"}},"name":"draft_url"}],"settingOnError":{"processType":1,"retryTimes":0,"timeoutMs":180000}},"nodeMeta":{"description":"批量添加音频","icon":"https://p9-flow-product-sign.byteimg.com/tos-cn-i-13w3uml6bg/324427c7589a426286a9774fa69f64a2~tplv-13w3uml6bg-resize:128:128.image?rk3s=2e2596fd&x-expires=1744623906&x-signature=P79MkA726AKIZjD2czgonFWuJnw%3D","subtitle":"视频合成_剪映小助手:add_audios","title":"add_audios_1"},"outputs":[{"name":"audio_ids","required":false,"schema":{"type":"string"},"type":"list"},{"name":"draft_url","required":false,"type":"string"},{"name":"track_id","required":false,"type":"string"}]},"edges":null,"id":"122915","meta":{"canvasPosition":{"x":0,"y":0},"defaultCollapsed":false,"position":{"x":3565.5436447166926,"y":118.51454823889745}},"type":"4","_temp":{"bounds":{"x":0,"y":0,"width":0,"height":0}}},{"blocks":[],"data":{"inputs":{"callTransferVoice":true,"chatHistoryWriting":"historyWrite","content":{"type":"string","value":{"type":"literal"}},"inputParameters":[{"input":{"schema":{"assistType":2,"type":"string"},"type":"list","value":{"content":{"blockID":"180681","name":"data_list","source":"block-output"},"rawMeta":{"type":104},"type":"ref"}},"name":"image_list"}],"streamingOutput":true},"nodeMeta":{"description":"节点从“消息”更名为“输出”，支持中间过程的消息输出，支持流式和非流式两种方式","icon":"https://lf3-static.bytednsdoc.com/obj/eden-cn/dvsmryvd_avi_dvsm/ljhwZthlaukjlkulzlp/icon/icon-Output-v2.jpg","mainColor":"#5C62FF","subTitle":"输出","title":"输出_图片"}},"edges":null,"id":"180456","meta":{"canvasPosition":{"x":0,"y":0},"defaultCollapsed":false,"position":{"x":-1694.4563552833074,"y":118.51454823889745}},"type":"13","_temp":{"bounds":{"x":0,"y":0,"width":0,"height":0}}}],"versions":{"batch":"v2","loop":"v2"}}}